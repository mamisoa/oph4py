[[extend "baseof.html"]]

[[ block page_head]]
<link href="js/bootstrap-table_1.22/bootstrap-table.min.css" rel="stylesheet">
<style>
    /* overide when topnavbar is not fixed-top */
    section#main { margin-top: 0px; }
</style>
[[ end ]]

[[ block left_nav ]]
[[ end]]

[[ include 'partials/patient-bar.html' ]]

<div class="container-fluid mb-3"> <!-- controller title-->
    <div class="row big-title bg-neutral">
        <div class="col">
            <h1><a role="button" data-bs-toggle="collapse" href=".md">Medical examination</a></h1>
        </div>
    </div>
</div>

<div id="hx-container" class="container-fluid mb-3"> <!-- Hx container-->
    <div class="row mb-3 big-title bg-primary">
        <div class="col">
            <h2><a role="button" data-bs-toggle="collapse" href=".history">Past history</a></h2>
        </div>
    </div>
    <div class="row history">
        <div class="col">
            <h3 class="big-title bg-secondary"><a role="button" data-bs-toggle="collapse" href=".gHx">General history</a></h3>
            <div class="row gHx">
                <div class="col">
                    <div class="row mb-3"> <!-- row medications -->
                        <div class="col">
                            <div class="row">
                                <div class="col">
                                    <h4 class="title-right">Medications</h4>
                                    <div>
                                        <button type="button" id="btnNewMx" class="btn btn-dark btn-sm" data-bs-toggle="modal" data-status-flag="historyMx" data-mx-flag="historyMx" data-bs-target="#mxModal">
                                            Add medication<i class="mx-2 fas fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-3 bg-right">
                                <div class="col">
                                    <table
                                        id="mx_tbl"
                                        data-side-pagination="server"
                                        data-toggle="table"
                                        data-pagination="true"
                                        data-page-size="10"
                                        data-search="false"
                                        data-query-params="queryParams"
                                        data-response-handler="responseHandler_mx"
                                        data-detail-formatter="detailFormatter_mx"
                                        data-detail-view="true"
                                        data-detail-view-icon="true"
                                        >
                                        <thead>
                                            <tr>
                                                <th data-field="onset" data-sortable="true">Onset</th>
                                                <th data-field="ended" data-sortable="false">Ended</th>
                                                <th data-field="medication" data-sortable="true">Medication</th>
                                                <th data-field="delivery" data-sortable="false">Delivery</th>
                                                <th data-field="frequency_h" data-sortable="false">Frequency</th>
                                                <th data-field="note" data-sortable="false">Note</th>
                                                <th data-field="prescribed" data-sortable="false">Prescribed</th>
                                                <th data-field="operate" data-formatter="operateFormatter_mx" data-events="operateEvents_mx">Action
                                                </th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="row mb-3">
                        <div class="row mb-3">
                            <div class="col">
                                <h4 class="big-title bg-warning">Allergy</h4>
                            </div>
                            <div>
                                <button type="button" id="btnNewAx" class="btn btn-dark btn-sm" data-bs-toggle="modal" data-bs-target="#axModal">
                                    Add allergy<i class="mx-2 fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        <div class="row mb-3 bg-neutral">
                            <div class="col">
                                <table
                                    id="ax_tbl"
                                    data-side-pagination="server"
                                    data-toggle="table"
                                    data-pagination="true"
                                    data-page-size="10"
                                    data-search="false"
                                    data-query-params="queryParams"
                                    data-row-style="rowStyle_ax"
                                    data-response-handler="responseHandler_ax"
                                    data-detail-formatter="detailFormatter_ax"
                                    data-detail-view="true"
                                    data-detail-view-icon="true"
                                    >
                                    <thead>
                                        <tr>
                                            <th data-field="onset" data-sortable="true">Onset</th>
                                            <th data-field="ended" data-sortable="false">Ended</th>
                                            <th data-field="typ" data-sortable="true">Type</th>
                                            <th data-field="agent" data-sortable="true">Agent</th>
                                            <th data-field="operate" data-formatter="operateFormatter_ax" data-events="operateEvents_ax">Action</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div> <!-- end div row medications allergy -->
            <div class="row gHx">
                <div class="col">
                    <div class="row mb-3"> <!-- row mHx -->
                        <div class="col">
                            <h4 class="title-right">Medical Hx</h4>
                            <div>
                                <button type="button" id="btnNewmHx" class="btn btn-dark btn-sm" data-bs-toggle="modal" data-bs-target="#mHxModal" data-category-flag="medical">Add past medical history<i class="mx-2 fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        <div class="row mt-3 bg-right"> <!-- mHx_tbl-->
                            <div class="col">
                                <table
                                    id="mHx_tbl"
                                    data-side-pagination="server"
                                    data-toggle="table"
                                    data-pagination="true"
                                    data-page-size="10"
                                    data-search="false"
                                    data-query-params="queryParams"
                                    data-response-handler="responseHandler_msHx"
                                    data-detail-formatter="detailFormatter_msHx"
                                    data-detail-view="true"
                                    data-detail-view-icon="true"
                                    >
                                    <thead>
                                        <tr>
                                            <th data-field="onset" data-sortable="true">Onset</th>
                                            <th data-field="ended" data-sortable="false">Ended</th>
                                            <th data-field="title" data-sortable="true">Title</th>
                                            <th data-field="icd10" data-sortable="true">ICD-10</th>
                                            <th data-field="site" data-sortable="true">Site</th>
                                            <th data-field="note" data-sortable="true">Note</th>
                                            <th data-field="operate" data-formatter="operateFormatter_msHx" data-events="operateEvents_msHx">Action</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div> <!-- end row mHx_tbl-->
                    </div>
                </div>
                <div class="col">
                    <div class="row mb-3">
                        <div class="row mb-3">
                            <h4 class="title-left">Surgical Hx</h4>
                            <div>
                                <button type="button" id="btnNewsHx" class="btn btn-dark btn-sm" data-bs-toggle="modal" data-bs-target="#mHxModal" data-category-flag="surgical">Add past surgical history<i class="mx-2 fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        <div class="row mb-3 bg-left">
                            <div class="col">
                                <table
                                    id="sHx_tbl"
                                    data-side-pagination="server"
                                    data-toggle="table"
                                    data-pagination="true"
                                    data-page-size="10"
                                    data-search="false"
                                    data-query-params="queryParams"
                                    data-response-handler="responseHandler_msHx"
                                    data-detail-formatter="detailFormatter_msHx"
                                    data-detail-view="true"
                                    data-detail-view-icon="true"
                                    >
                                    <thead>
                                        <tr>
                                            <th data-field="onset" data-sortable="true">Onset</th>
                                            <th data-field="ended" data-sortable="false">Ended</th>
                                            <th data-field="title" data-sortable="true">Title</th>
                                            <th data-field="icd10" data-sortable="true">ICD-10</th>
                                            <th data-field="site" data-sortable="true">Site</th>
                                            <th data-field="note" data-sortable="true">Note</th>
                                            <th data-field="operate" data-formatter="operateFormatter_msHx" data-events="operateEvents_msHx">Action</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div> <!-- end div row mHx sHx -->
        </div>
    </div>
    <div class="row history">
        <h3 class="big-title bg-info"><a role="button" data-bs-toggle="collapse" href=".oHx">Ocular history</a></h3>
        [[ if userMembership == 'Doctor':]]
        <div class="row mb-3 bg-neutral"> <!-- row oHx-->
            <div class="col oHx">
                <table
                    id="oHx_tbl"
                    data-side-pagination="server"
                    data-toggle="table"
                    data-pagination="true"
                    data-page-size="10"
                    data-search="false"
                    data-query-params="queryParams"
                    data-response-handler="responseHandler_msHx"
                    data-detail-formatter="detailFormatter_msHx"
                    data-detail-view="true"
                    data-detail-view-icon="true"
                    >
                    <thead>
                        <tr>
                            <th data-field="onset" data-sortable="true">Onset</th>
                            <th data-field="ended" data-sortable="false">Ended</th>
                            <th data-field="title" data-sortable="true">Title</th>
                            <th data-field="icd10" data-sortable="true">ICD-10</th>
                            <th data-field="site" data-sortable="true">Side</th>
                            <th data-field="note" data-sortable="true">Note</th>
                            <th data-field="operate" data-formatter="operateFormatter_msHx" data-events="operateEvents_msHx">Action</th>
                        </tr>
                    </thead>
                </table>
            </div> <!-- end oHx col-->
        </div> <!-- end oHx row-->
        [[ pass ]]
        <div class="row mb-3 oHx"> <!-- row wlHx-->
            <div class="col">
                <h4><span class=""><i class="fas fa-list me-2"></i>Worklist<span></h4>
                <div id="toolbar-wl">
                </div>
                <table id="table-wl"
                    data-toolbar-align="right"
                    data-toolbar="#toolbar-wl"
                    data-id-field="id"
                    data-toggle="table"
                    data-side-pagination="server"
                    data-show-refresh="true"
                    data-pagination="true"
                    data-page-size="5"
                    data-show-columns="true"
                    data-show-refresh="true"
                    data-search="true"
                    data-search-accent-neutralise="true"
                    data-visible-search="false"
                    data-query-params="queryParams_wl"
                    data-response-handler="responseHandler_wl"
                    data-row-style="rowStyle_wl"
                    data-detail-view="true"
                    data-detail-view-icon="true"
                    data-detail-formatter="detailFormatter_wl"
                    data-detail-view-by-click="false"
                    >
                    <thead class="thead-dark">
                        <th data-field="id" data-sortable="true">ID</th>
                        <th data-field="sending_facility" data-sortable="true">Sending facility:</th>
                        <th data-field="receiving_facility" data-title="Receiving facility" data-sortable="true">Receving facility:</th>
                        <th data-field="procedure" data-searchable= "true" data-sortable="true">Procedure:</th>
                        <th data-field="provider" data-searchable= "true" data-sortable="true">Provider:</th>
                        <th data-field="senior" data-searchable="true" data-sortable="true">Senior:</th>
                        <th data-field="modality" data-searchable= "true" data-sortable="true">Modality:</th>
                        <th data-field="laterality" data-sortable="false" data-searchable= "false">Laterality:</th>
                        <th data-field="requested_time" data-sortable="true" data-searchable= "true">Timeslot:</th>
                        <th data-field="status_flag" data-searchable= "true" data-sortable="true">Status:</th>
                        <th data-field="counter" data-searchable= "true" data-sortable="false" data-formatter="counterFormatter_wl">Counter:</th>
                        <th data-field="warning" data-searchable= "true" data-sortable="false">Warning:</th>
                        <th data-field="operate" data-formatter="operateFormatter_wl" data-events="operateEvents_wl">Action</th>
                    </thead>
                </table>
            </div>
        </div> <!-- end row wlHx-->
        <div class="row mb-3 oHx"> <!-- row tono-->
            <div class="col"> <!-- right column-->
                <div class="row">
                    <div class="col">
                        <h4 class="title-right">Right tono</h4>
                    </div>
                </div>
                <div class="row bg-right">
                    <div class="col"> <!-- right table tono-->
                        <table
                            id="tonoRight_tbl"
                            data-side-pagination="server"
                            data-pagination="true"
                            data-page-size="10"
                            data-search="false"
                            data-query-params="queryParams"
                            data-response-handler="responseHandler_tono"
                            data-detail-view="true"
                            data-detail-view-icon="true"
                            data-detail-formatter="detailFormatter_tono"
                            data-detail-view-by-click="false"
                            >
                            <thead>
                                <tr>
                                    <th data-field="timestamp" data-sortable="true">Timestamp</th>
                                    <th data-field="tonometry" data-sortable="true">Tono</th>
                                    <th data-field="techno" data-sortable="true">Method</th>
                                    <th data-field="pachymetry" data-sortable="true">Pachy</th>
                                    <th data-field="operate" data-formatter="operateFormatter_tono" data-events="operateEvents_tono">Action</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col"> <!-- left column -->
                <div class="row">
                    <div class="col">
                        <h4 class="title-left">Left tono</h4>
                    </div>
                </div>
                <div class="row bg-left">
                    <div class="col"> <!-- left table tono-->
                        <table
                        id="tonoLeft_tbl"
                        data-toggle="table"
                        data-side-pagination="server"
                        data-pagination="true"
                        data-page-size="10"
                        data-query-params="queryParams"
                        data-response-handler="responseHandler_tono"
                        data-detail-view="true"
                        data-detail-view-icon="true"
                        data-detail-formatter="detailFormatter_tono"
                        data-detail-view-by-click="false"
                        >
                        <thead>
                            <tr>
                                <th data-field="timestamp" data-sortable="true">Timestamp</th>
                                <th data-field="tonometry" data-sortable="true">Tono</th>
                                <th data-field="techno" data-sortable="true">Method</th>
                                <th data-field="pachymetry" data-sortable="true">Pachy</th>
                                <th data-field="operate" data-formatter="operateFormatter_tono" data-events="operateEvents_tono">Action</th>
                            </tr>
                        </thead>
                    </table>
                    </div> 
                </div>
            </div>
        </div> <!-- end row tono-->
        <div class="row mb-3 oHx"> <!-- row rx-->
            <div class="col"> <!-- right column-->
                <div class="row">
                    <div class="col">
                        <h4 class="title-right">Right rx</h4>
                    </div>
                </div>
                <div class="row bg-right">
                    <div class="col"> <!-- right table rx-->
                        <table
                            id="rxRight_tbl"
                            data-side-pagination="server"
                            data-pagination="true"
                            data-page-size="5"
                            data-search="false"
                            data-query-params="queryParams"
                            data-response-handler="responseHandler_rx"
                            data-detail-formatter="detailFormatter_rx"
                            data-row-style="rowStyle_type"
                            data-detail-view="true"
                            data-detail-view-icon="true"
                            >
                            <thead>
                                <tr>
                                    <th data-field="timestamp" data-sortable="true">Timestamp</th>
                                    <th data-field="rx_origin" data-sortable="true">Type</th>
                                    <th data-field="note" data-sortable="false">Note</th>
                                    <th data-field="va_far" data-sortable="true">VA far</th>
                                    <th data-field="rx_far" data-cell-style="cellStyle_formula" data-sortable="false">Rx far</th>
                                    <th data-field="se_far" data-cell-style="cellStyle_formula" data-sortable="false">SE</th>
                                    <th data-field="add" data-cell-style="cellStyle_add" data-sortable="false">Add</th>
                                    <th data-field="va_close" data-sortable="true">VA close</th>
                                    <th data-field="operate" data-formatter="operateFormatter_rx" data-events="operateEvents_rx">Action</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
                <div class="row bg-right">
                    <div class="col"> <!-- right table km-->
                        <table
                        id="kmRight_tbl"
                        data-side-pagination="server"
                        data-pagination="true"
                        data-page-size="5"
                        data-search="false"
                        data-query-params="queryParams"
                        data-response-handler="responseHandler_km"
                        data-detail-formatter="detailFormatter_km"
                        data-row-style="rowStyle_km"
                        data-detail-view="true"
                        data-detail-view-icon="true"
                        >
                            <thead>
                                <tr>
                                    <th data-field="timestamp" data-sortable="true">Timestamp</th>
                                    <th data-field="formulak1" data-sortable="false" data-cell-style="cellStyle_k1">K1</th>
                                    <th data-field="formulak2" data-sortable="false" data-cell-style="cellStyle_k2">K2</th>
                                    <th data-field="operate" data-formatter="operateFormatter_km" data-events="operateEvents_km">Action</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col"> <!-- left column -->
                <div class="row">
                    <div class="col">
                        <h4 class="title-left">Left rx</h4>
                    </div>
                </div>
                <div class="row bg-left">
                    <div class="col"> <!-- left table rx-->
                        <table
                            id="rxLeft_tbl"
                            data-side-pagination="server"
                            data-pagination="true"
                            data-page-size="5"
                            data-search="false"
                            data-query-params="queryParams"
                            data-response-handler="responseHandler_rx"
                            data-detail-formatter="detailFormatter_rx"
                            data-row-style="rowStyle_type"
                            data-detail-view="true"
                            data-detail-view-icon="true"
                            >
                            <thead>
                                <tr>
                                    <th data-field="timestamp" data-sortable="true">Timestamp</th>
                                    <th data-field="rx_origin" data-sortable="true">Type</th>
                                    <th data-field="note" data-sortable="false">Note</th>
                                    <th data-field="va_far" data-sortable="true">VA far</th>
                                    <th data-field="rx_far" data-cell-style="cellStyle_formula" data-sortable="false">Rx far</th>
                                    <th data-field="se_far" data-cell-style="cellStyle_formula" data-sortable="false">SE</th>
                                    <th data-field="add" data-cell-style="cellStyle_add" data-sortable="false">Add</th>
                                    <th data-field="va_close" data-sortable="true">VA close</th>
                                    <th data-field="operate" data-formatter="operateFormatter_rx" data-events="operateEvents_rx">Action</th>
                                </tr>
                            </thead>
                        </table>
                    </div> 
                </div>
                <div class="row bg-left">
                    <div class="col"> <!-- left table km-->
                        <table
                        id="kmLeft_tbl"
                        data-side-pagination="server"
                        data-pagination="true"
                        data-page-size="5"
                        data-search="false"
                        data-query-params="queryParams"
                        data-response-handler="responseHandler_km"
                        data-detail-formatter="detailFormatter_km"
                        data-row-style="rowStyle_km"
                        data-detail-view="true"
                        data-detail-view-icon="true"
                        >
                            <thead>
                                <tr>
                                    <th data-field="timestamp" data-sortable="true">Timestamp</th>
                                    <th data-field="formulak1" data-sortable="false" data-cell-style="cellStyle_k1">K1</th>
                                    <th data-field="formulak2" data-sortable="false" data-cell-style="cellStyle_k2">K2</th>
                                    <th data-field="operate" data-formatter="operateFormatter_km" data-events="operateEvents_km">Action</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div> <!-- end row rx-->
    </div> <!-- end row oHx -->
</div> <!-- end Hx container-->
<div class="container-fluid mb-3" id="cHxDiv">
    <div class="row">
        <div class="col text-center">
            <h2 class="big-title bg-info"><a role="button" data-bs-toggle="collapse" href=".cHx">Present History</a></h2>
        </div>
    </div>
    <div class="row cHx py-2 bg-right">
        <div class="col">
            <form id="cHxForm" enctype="multipart/form-data" method="POST"> 
                <div class="container-fluid">
                    <div class="row">
                        <div class="col" id="descriptionCol">
                            <div class="input-group">
                                <button id="cHxFormSubmit" type="submit" class="btn btn-secondary">Update<i class="mx-2 fas fa-plus"></i></button>
                                <textarea class="form-control" aria-label="With textarea" name="description">[[ = XML(currentHx['description']) ]]</textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <input id="idcHx" type="text" class="visually-hidden" name="id" value="[[ = XML(currentHx['id']) ]]"/>
                <input id="idPatientcHx" type="text" class="visually-hidden" name="id_auth_user"/>
                <input id="idWlcHx" type="text" class="visually-hidden" name="id_worklist"/>
            </form>
        </div>
    </div>
</div> <!-- end cHx container-->
<div id="cx-container" class="container-fluid mb-3"> <!-- container clinical exam -->
    <div class="row mb-3 big-title bg-primary">
        <div>
            <h2><a role="button" data-bs-toggle="collapse" href=".clinical">Clinical exam</a></h2>
        </div>
    </div>
    [[ if userMembership == 'Doctor':]]
    <div class="row mb-3 clinical">
        <div class="col"> <!-- 1 col -->
            <div class="row mb-3"> <!-- 1 row -->
                <div class="col"> <!-- right eye col -->
                    <div class="row"> <!-- row title right eye col -->
                        <div class="col">
                            <h3 class="title-right">Right eye</h3>
                        </div>
                    </div> <!-- end row title right eye col -->
                    <div class="row bg-right"> <!-- anterior and posterior right forms row -->
                        <div class="col py-3"> <!-- antRight col -->
                            <h5 class="text-center">Anterior exam</h5>
                            <form id="antRightForm" enctype="multipart/form-data" method="POST"> 
                                <div class="container-fluid">
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="antRightantChamber" class="form-control" aria-label="anterior chamber exam" name="ant_chamb" value="[[ = XML(antRight['ant_chamb']) ]]" autocomplete="on"/>
                                                <label for="antRightantChamber">Anterior segment exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="antRightouter" class="form-control" aria-label="Outer findings" name="outer" value="[[ = XML(antRight['outer']) ]]" autocomplete="on"/>
                                                <label for="antRightouter">Outer findings (eyelids, conjunctiva...)</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="antRightCornea" class="form-control" aria-label="cornea exam" name="cornea" value="[[ = XML(antRight['cornea']) ]]" autocomplete="on"/>
                                                <label for="antRightCornea">Cornea exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="antRightIris" class="form-control" aria-label="iris exam" name="iris" value="[[ = XML(antRight['iris']) ]]" autocomplete="on"/>
                                                <label for="antRightIris">Iris exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="antRightLens" class="form-control" aria-label="lens exam" name="lens" value="[[ = XML(antRight['lens']) ]]" autocomplete="on"/>
                                                <label for="antRightLens">Lens exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="antRightOther" class="form-control" aria-label="lens exam" name="other" value="[[ = XML(antRight['other']) ]]" autocomplete="on"/>
                                                <label for="antRightOther">Other findings</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="container-fluid">
                                    <input id="lateralityantRight" type="text" class="visually-hidden" name="laterality" value="right"/>
                                    <input id="idantRight" type="text" class="visually-hidden" name="id" value="[[ = XML(antRight['id']) ]]"/>
                                    <input id="idPatientantRight" type="text" class="visually-hidden" name="id_auth_user"/>
                                    <input id="idWlantRight" type="text" class="visually-hidden" name="id_worklist"/>
                                    <button id="antRightFormSubmit" type="submit" class="btn btn-secondary">Update<i class="mx-2 fas fa-plus"></i></button>
                                </div>
                            </form>
                        </div> <!-- antRight end col -->
                        <div class="col pt-3"> <!-- postRight col -->
                            <h5 class="text-center">Posterior exam</h5>
                            <form id="postRightForm" enctype="multipart/form-data" method="POST"> 
                                <div class="container-fluid">
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="postRightpost_chamb" class="form-control" aria-label="posterior segment exam" name="post_chamb" value="[[ = XML(postRight['post_chamb']) ]]" autocomplete="on"/>
                                                <label for="postRightpost_chamb">Posterior segment exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="postRightVitreous" class="form-control" aria-label="vitreous exam" name="vitreous" value="[[ = XML(postRight['vitreous']) ]]" autocomplete="on"/>
                                                <label for="postRightVitreous">Vitreous exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="postRightRetina" class="form-control" aria-label="retina exam" name="retina" value="[[ = XML(postRight['retina']) ]]" autocomplete="on"/>
                                                <label for="postRightRetina">Retina exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="postRightMacula" class="form-control" aria-label="macula exam" name="macula" value="[[ = XML(postRight['macula']) ]]" autocomplete="on"/>
                                                <label for="postRightMacula">Macula exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="postRightPapil" class="form-control" aria-label="papil exam" name="papil" value="[[ = XML(postRight['papil']) ]]" autocomplete="on"/>
                                                <label for="postRightPapil">Papil exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="postRightOther" class="form-control" aria-label="lens exam" name="other" value="[[ = XML(postRight['other']) ]]" autocomplete="on"/>
                                                <label for="postRightOther">Other findings</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="container-fluid">
                                    <input id="lateralitypostRight" type="text" class="visually-hidden" name="laterality" value="right"/>
                                    <input id="idpostRight" type="text" class="visually-hidden" name="id" value="[[ = XML(postRight['id']) ]]"/>
                                    <input id="idPatientpostRight" type="text" class="visually-hidden" name="id_auth_user"/>
                                    <input id="idWlpostRight" type="text" class="visually-hidden" name="id_worklist"/>
                                    <button id="postRightFormSubmit" type="submit" class="btn btn-secondary">Update<i class="mx-2 fas fa-plus"></i></button>
                                </div>
                            </form>
                        </div>
                    </div> <!-- end anterior and posterior right forms row -->
                </div> <!-- end right eye col -->
                <div class="col"> <!-- left eye col -->
                    <div class="row"> <!-- row title left eye col -->
                        <div class="col">
                            <h3 class="title-left">Left eye</h3>
                        </div>
                    </div> <!-- end row title left eye col -->
                    <div class="row bg-left"> <!-- anterior and posterior left forms row -->
                        <div class="col py-3"> <!-- antLeft col -->
                            <h5 class="text-center">Anterior exam</h5>
                            <form id="antLeftForm" enctype="multipart/form-data" method="POST"> 
                                <div class="container-fluid">
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="antLeftantChamber" class="form-control" aria-label="anterior chamber exam" name="ant_chamb" value="[[ = XML(antLeft['ant_chamb']) ]]" autocomplete="on"/>
                                                <label for="antLeftantChamber">Anterior segment exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="antLeftouter" class="form-control" aria-label="Outer findings" name="outer" value="[[ = XML(antLeft['outer']) ]]" autocomplete="on"/>
                                                <label for="antLeftouter">Outer findings (eyelids, conjunctiva...)</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="antLeftCornea" class="form-control" aria-label="cornea exam" name="cornea" value="[[ = XML(antLeft['cornea']) ]]" autocomplete="on"/>
                                                <label for="antLeftCornea">Cornea exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="antLeftIris" class="form-control" aria-label="iris exam" name="iris" value="[[ = XML(antLeft['iris']) ]]" autocomplete="on"/>
                                                <label for="antLeftIris">Iris exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="antLeftLens" class="form-control" aria-label="lens exam" name="lens" value="[[ = XML(antLeft['lens']) ]]" autocomplete="on"/>
                                                <label for="antLeftLens">Lens exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="antLeftOther" class="form-control" aria-label="lens exam" name="other" value="[[ = XML(antLeft['other']) ]]" autocomplete="on"/>
                                                <label for="antLeftOther">Other findings</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="container-fluid">
                                    <input id="lateralityantLeft" type="text" class="visually-hidden" name="laterality" value="left"/>
                                    <input id="idantLeft" type="text" class="visually-hidden" name="id" value="[[ = XML(antLeft['id']) ]]"/>
                                    <input id="idPatientantLeft" type="text" class="visually-hidden" name="id_auth_user"/>
                                    <input id="idWlantLeft" type="text" class="visually-hidden" name="id_worklist"/>
                                    <button id="antLeftFormSubmit" type="submit" class="btn btn-secondary">Update<i class="mx-2 fas fa-plus"></i></button>
                                </div>
                            </form>
                        </div> <!-- end antLeft col -->
                        <div class="col py-3"> <!-- postLeft form col -->
                            <h5 class="text-center">Posterior exam</h5>
                            <form id="postLeftForm" enctype="multipart/form-data" method="POST"> 
                                <div class="container-fluid">
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="postLeftpost_chamb" class="form-control" aria-label="post segment exam" name="post_chamb" value="[[ = XML(postLeft['post_chamb']) ]]" autocomplete="on"/>
                                                <label for="postLeftpost_chamb">Posterior segment exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="postLeftVitreous" class="form-control" aria-label="vitreous exam" name="vitreous" value="[[ = XML(postLeft['vitreous']) ]]" autocomplete="on"/>
                                                <label for="postLeftVitreous">Vitreous exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="postLeftRetina" class="form-control" aria-label="retina exam" name="retina" value="[[ = XML(postLeft['retina']) ]]" autocomplete="on"/>
                                                <label for="postLeftRetina">Retina exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="postLeftMacula" class="form-control" aria-label="macula exam" name="macula" value="[[ = XML(postLeft['macula']) ]]" autocomplete="on"/>
                                                <label for="postLeftMacula">Macula exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="postLeftPapil" class="form-control" aria-label="papil exam" name="papil" value="[[ = XML(postLeft['papil']) ]]" autocomplete="on"/>
                                                <label for="postLeftPapil">Papil exam</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <div class="form-floating">
                                                <input type="text" id="postLeftOther" class="form-control" aria-label="lens exam" name="other" value="[[ = XML(postLeft['other']) ]]" autocomplete="on"/>
                                                <label for="postLeftOther">Other findings</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="container-fluid">
                                    <input id="lateralitypostLeft" type="text" class="visually-hidden" name="laterality" value="left"/>
                                    <input id="idpostLeft" type="text" class="visually-hidden" name="id" value="[[ = XML(postLeft['id']) ]]"/>
                                    <input id="idPatientpostLeft" type="text" class="visually-hidden" name="id_auth_user"/>
                                    <input id="idWlpostLeft" type="text" class="visually-hidden" name="id_worklist"/>
                                    <button id="postLeftFormSubmit" type="submit" class="btn btn-secondary">Update<i class="mx-2 fas fa-plus"></i></button>
                                </div>
                            </form>
                        </div> <!-- end postLeft form col -->
                    </div> <!-- end anterior and posterior left forms row -->
                </div> <!-- end left eye col -->
            </div> <!-- end 1 row -->
        </div> <!-- end 1 col -->
    </div>
    [[ pass ]]
    <div class="row mb-3 clinical">
        <div class="col">
            <div class="row">
                <div class="col">
                    <div class="row">
                        <div class="col">
                            <h3 class="big-title bg-secondary"><a role="button" data-bs-toggle="collapse" href=".misc">Miscellaneous</a></h3>
                        </div>
                    </div>
                    <div class="row misc">
                        <div class="col">
                            <div class="row">
                                <div class="col">
                                    <h4 class="big-title">Motility</h4>
                                </div>
                            </div>
                            <div class="row py-2 bg-right">
                                <div class="col">
                                    <form id="motForm" enctype="multipart/form-data" method="POST"> 
                                        <div class="container-fluid">
                                            <div class="row">
                                                <div class="col">
                                                    <div class="input-group">
                                                        <button id="motFormSubmit" type="submit" class="btn btn-secondary">Update<i class="mx-2 fas fa-plus"></i></button>
                                                        <textarea class="form-control" aria-label="With textarea" name="description">[[ = XML(motility['description']) ]]</textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <input id="idmot" type="text" class="visually-hidden" name="id" value="[[ = XML(motility['id']) ]]"/>
                                        <input id="idPatientmot" type="text" class="visually-hidden" name="id_auth_user"/>
                                        <input id="idWlmot" type="text" class="visually-hidden" name="id_worklist"/>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <div class="row">
                                <div class="col">
                                    <h4 class="big-title">Phoria</h4>
                                </div>
                            </div>
                            <div class="row py-2 bg-left">
                                <div class="col">
                                    <form id="phoForm" enctype="multipart/form-data" method="POST"> 
                                        <div class="container-fluid">
                                            <div class="row">
                                                <div class="col">
                                                    <div class="input-group">
                                                        <button id="phoFormSubmit" type="submit" class="btn btn-secondary">Update<i class="mx-2 fas fa-plus"></i></button>
                                                        <textarea class="form-control" aria-label="With textarea" name="description">[[ = XML(phoria['description']) ]]</textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <input id="idpho" type="text" class="visually-hidden" name="id" value="[[ = XML(phoria['id']) ]]"/>
                                        <input id="idPatientpho" type="text" class="visually-hidden" name="id_auth_user"/>
                                        <input id="idWlpho" type="text" class="visually-hidden" name="id_worklist"/>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <div class="row">
                                <div class="col">
                                    <h4 class="big-title">Pupils</h4>
                                </div>
                            </div>
                            <div class="row py-2 bg-right">
                                <div class="col">
                                    <form id="pupForm" enctype="multipart/form-data" method="POST"> 
                                        <div class="container-fluid">
                                            <div class="row">
                                                <div class="col">
                                                    <div class="input-group">
                                                        <button id="pupFormSubmit" type="submit" class="btn btn-secondary">Update<i class="mx-2 fas fa-plus"></i></button>
                                                        <textarea class="form-control" aria-label="With textarea" name="description">[[ = XML(pupils['description']) ]]</textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <input id="idpup" type="text" class="visually-hidden" name="id" value="[[ = XML(pupils['id']) ]]"/>
                                        <input id="idPatientpup" type="text" class="visually-hidden" name="id_auth_user"/>
                                        <input id="idWlpup" type="text" class="visually-hidden" name="id_worklist"/>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div> <!-- end clinical exam container-->
<div id="cc-container" class="container-fluid mb-3"> <!-- container conclusions -->
    <div class="row mb-3">
        <div class="col">
            <div class="row">
                <div class="col big-title bg-primary">
                    <h2><a role="button" data-bs-toggle="collapse" href=".dx">Conclusions</a></h2>
                </div>
            </div>
            <div class="row bg-right py-3 dx">
                <div class="col">
                    <form id="ccxForm" enctype="multipart/form-data" method="POST"> 
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col">
                                    <div class="input-group">
                                        <button id="ccxFormSubmit" type="submit" class="btn btn-secondary">Update<i class="mx-2 fas fa-plus"></i></button>
                                        <textarea class="form-control" aria-label="With textarea" name="description">[[ = XML(ccx['description']) ]]</textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <input id="lateralityccx" type="text" class="visually-hidden" name="laterality" value="na"/>
                        <input id="idccx" type="text" class="visually-hidden" name="id" value="[[ = XML(ccx['id']) ]]"/>
                        <input id="idPatientccx" type="text" class="visually-hidden" name="id_auth_user" value="[[=patientId]]"/>
                        <input id="idWlccx" type="text" class="visually-hidden" name="id_worklist" value="[[=wlId]]"/>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="row mb-3 dx">
        <div class="col">
            <div class="row">
                <div class="col">
                    <div class="row">
                        <div class="col">
                            <h3 class="title-right">Right eye</h3>
                        </div>
                    </div>
                    <div class="row bg-right py-3">
                        <div class="col">
                            <form id="ccxRForm" enctype="multipart/form-data" method="POST"> 
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col">
                                            <div class="input-group">
                                                <button id="ccxRFormSubmit" type="submit" class="btn btn-secondary">Update<i class="mx-2 fas fa-plus"></i></button>
                                                <textarea class="form-control" aria-label="With textarea" name="description">[[ = XML(ccxR['description']) ]]</textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <input id="lateralityccxR" type="text" class="visually-hidden" name="laterality" value="right"/>
                                <input id="idccxR" type="text" class="visually-hidden" name="id" value="[[ = XML(ccxR['id']) ]]"/>
                                <input id="idPatientccxR" type="text" class="visually-hidden" name="id_auth_user" value="[[=patientId]]"/>
                                <input id="idWlccxR" type="text" class="visually-hidden" name="id_worklist" value="[[=wlId]]"/>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="row">
                        <div class="col">
                            <h3 class="title-left">Left eye</h3>
                        </div>
                    </div>
                    <div class="row bg-left py-3">
                        <div class="col">
                            <form id="ccxLForm" enctype="multipart/form-data" method="POST"> 
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col">
                                            <div class="input-group">
                                                <button id="ccxLFormSubmit" type="submit" class="btn btn-secondary">Update<i class="mx-2 fas fa-plus"></i></button>
                                                <textarea class="form-control" aria-label="With textarea" name="description">[[ = XML(ccxL['description']) ]]</textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <input id="lateralityccxL" type="text" class="visually-hidden" name="laterality" value="left"/>
                                <input id="idccxL" type="text" class="visually-hidden" name="id" value="[[ = XML(ccxR['id']) ]]"/>
                                <input id="idPatientccxL" type="text" class="visually-hidden" name="id_auth_user" value="[[=patientId]]"/>
                                <input id="idWlccxL" type="text" class="visually-hidden" name="id_worklist" value="[[=wlId]]"/>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row mb-3 dx">
        <div class="col">
            <div class="row">
                <div class="col">
                    <h3 class="title-right">Coding</h3>
                </div>
            </div>
            <div class="row bg-right">
                <div class="col ">
                    <button type="button" id="btnNewCoding" class="btn btn-dark btn-sm" data-bs-toggle="modal" data-bs-target="#mHxModal" data-category-flag="medical" data-mhx-flag="code">Add code<i class="mx-2 fas fa-plus"></i></button>
                    <table
                        id="coding_tbl"
                        data-side-pagination="server"
                        data-toggle="table"
                        data-pagination="true"
                        data-page-size="5"
                        data-search="false"
                        data-query-params="queryParams"
                        data-response-handler="responseHandler_msHx"
                        data-detail-formatter="detailFormatter_msHx"
                        data-detail-view="true"
                        data-detail-view-icon="true"
                        >
                        <thead>
                            <tr>
                                <th data-field="onset" data-sortable="true">Onset</th>
                                <th data-field="ended" data-sortable="false">Ended</th>
                                <th data-field="title" data-sortable="true">Title</th>
                                <th data-field="icd10" data-sortable="true">ICD-10</th>
                                <th data-field="site" data-sortable="true">Side</th>
                                <th data-field="note" data-sortable="true">Note</th>
                                <th data-field="operate" data-formatter="operateFormatter_msHx" data-events="operateEvents_msHx">Action</th>
                            </tr>
                        </thead>
                    </table>
                </div> <!-- end coding col-->
            </div>
        </div>
    </div>
</div>
<div id="x-container" class="container-fluid mb-3"> <!-- container actions -->
    <div class="row mb-3 big-title bg-warning">
        <div class="col">
            <h2><a role="button" data-bs-toggle="collapse" href=".actions">Actions</a></h2>
        </div>
    </div>
    <div class="row mb-3 actions">
        [[ if userMembership == 'Doctor':]]
        <div class="col">
            <div class="row">
                <div class="col">
                    <div class="col">
                        <h3 class="title-right">Medical Rx</h3>
                    </div>
                </div>
            </div>
            <div class="row bg-right">
                <div class="col">
                    <button type="button" id="btnNewMxWl" class="btn btn-dark btn-sm " data-bs-toggle="modal" data-bs-target="#mxModal" data-mx-flag="mxWl">Add medic<i class="mx-2 fas fa-plus"></i></button>
                    <button type="button" id="btnMxRx" class="btn btn-warning btn-sm float-end" >Prescribe medications<i class="mx-2 fas fa-prescription"></i></button>
                    <table
                        id="mxWl_tbl"
                        data-side-pagination="server"
                        data-toggle="table"
                        data-pagination="true"
                        data-page-size="5"
                        data-search="false"
                        data-query-params="queryParams"
                        data-response-handler="responseHandler_mx"
                        data-detail-formatter="detailFormatter_mx"
                        data-detail-view="true"
                        data-detail-view-icon="true"
                        >
                        <thead>
                            <tr>
                                <th data-field="onset" data-sortable="true">Onset</th>
                                <th data-field="ended" data-sortable="false">Ended</th>
                                <th data-field="medication" data-sortable="true">Medication</th>
                                <th data-field="delivery" data-sortable="false">Delivery</th>
                                <th data-field="frequency_h" data-sortable="false">Frequency</th>
                                <th data-field="note" data-sortable="false">Note</th>
                                <th data-field="prescribed" data-sortable="false">Prescribed</th>
                                <th data-field="operate" data-formatter="operateFormatter_mx" data-events="operateEvents_mx">Action
                                </th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
            <div class="row bg-right">
                <div class="col">
                    <h4 class="title-right">List of printed medical prescriptions</h4>
                    <table
                        id="mxrx_tbl"
                        data-side-pagination="server"
                        data-toggle="table"
                        data-pagination="true"
                        data-page-size="5"
                        data-search="false"
                        data-query-params="queryParams"
                        data-response-handler="responseHandler_mxrx"
                        data-detail-formatter="detailFormatter_mxrx"
                        data-detail-view="true"
                        data-detail-view-icon="true"
                        >
                        <thead>
                            <tr>
                                <th data-field="created_on" data-sortable="true">Created:</th>
                                <th data-field="mx_names" data-sortable="false">Medication</th>
                                <th data-field="operate" data-formatter="operateFormatter_mxrx" data-events="operateEvents_mxrx">Action
                                </th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div> <!-- end medical action col row-->
        [[ pass ]]
        <div class="col">
            <div class="row">
                <div class="col">
                    <h3 class="title-left">Glass Rx</h3>
                </div>
            </div>
            <div class="row bg-left">
                <div class="col">
                    <button type="button" id="btnGxRx" class="btn btn-warning btn-sm mx-2 float-end" >Prescribe glasses<i class="mx-2 fas fa-glasses"></i></button>
                    <table
                        id="GxRx_tbl"
                        data-side-pagination="server"
                        data-toggle="table"
                        data-pagination="true"
                        data-page-size="5"
                        data-search="false"
                        data-query-params="queryParams"
                        data-response-handler="responseHandler_gx"
                        data-detail-formatter="detailFormatter_gx"
                        data-detail-view="true"
                        data-detail-view-icon="true"
                        >
                        <thead>
                            <tr>
                                <th data-field="datestamp" data-sortable="true">Datestamp</th>
                                <th data-field="glass_type" data-sortable="false">Glass type</th>
                                <th data-field="formulaR" data-sortable="true">Rx right</th>
                                <th data-field="formulaL" data-sortable="true">Rx left</th>
                                <th data-field="operate" data-formatter="operateFormatter_gx" data-events="operateEvents_gx">Action</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
            <div class="row bg-left">
                <div class="col">
                    <h4 class="title-left">List of printed lenses prescriptions</h4>
                    <button type="button" id="btnCxRx" class="btn btn-warning btn-sm mx-2 float-end" >Prescribe contacts<i class="mx-2 fas fa-bullseye"></i></button>
                    <table
                        id="cxrx_tbl"
                        data-side-pagination="server"
                        data-toggle="table"
                        data-pagination="true"
                        data-page-size="5"
                        data-search="false"
                        data-query-params="queryParams"
                        data-response-handler="responseHandler_cxrx"
                        data-detail-formatter="detailFormatter_cxrx"
                        data-detail-view="true"
                        data-detail-view-icon="true"
                        >
                        <thead>
                            <tr>
                                <th data-field="datestamp" data-sortable="true">Datestamp</th>
                                <th data-field="lensnameR" data-sortable="false">Right lens</th>
                                <th data-field="formulaR" data-sortable="true">Rx right</th>
                                <th data-field="lensnameR" data-sortable="false">Left lens</th>
                                <th data-field="formulaL" data-sortable="true">Rx left</th>
                                <th data-field="operate" data-formatter="operateFormatter_cxrx" data-events="operateEvents_cxrx">Action</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div> <!-- end glasses/lenses action col row-->
        <div class="col">
            <div class="row">
                <div class="col">
                    <h3 class="title-right">Papers</h3>
                </div>
            </div>
            <div class="row bg-right">
                <div class="col">
                    <h4 class="title-right">List of printed certificates</h4>
                    <button type="button" id="btnNewcertificate" class="btn btn-info btn-sm" data-bs-toggle="modal" data-bs-target="#certificateModal" data-cert-flag="presence">Presence certificate<i class="mx-2 fas fa-plus"></i></button>
                    <button type="button" id="btnNewcertsickleave" class="btn btn-dark btn-sm" data-bs-toggle="modal" data-bs-target="#sickModal">Sick leave certificate<i class="mx-2 fas fa-plus"></i></button>
                    <button type="button" id="btnNewfreecertificate" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#certificateModal" data-cert-flag="free">Free certificate<i class="mx-2 fas fa-plus"></i></button>
                    <button type="button" id="btnNewdoccertificate" class="btn btn-secondary btn-sm" data-bs-toggle="modal" data-bs-target="#certificateModal" data-cert-flag="doc">MD certificate<i class="mx-2 fas fa-plus"></i></button>
                    <button type="button" id="btnNeworthocertificate" class="btn btn-warning btn-sm" data-bs-toggle="modal" data-bs-target="#certificateModal" data-cert-flag="ortho">Ortho certificate<i class="mx-2 fas fa-plus"></i></button>
                    <button type="button" id="btnNewpreopcertificate" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#certificateModal" data-cert-flag="preop">Preop certificate<i class="mx-2 fas fa-plus"></i></button>
                    <button type="button" id="btnNewpostopcertificate" class="btn btn-secondary btn-sm" data-bs-toggle="modal" data-bs-target="#certificateModal" data-cert-flag="postop">Postop certificate<i class="mx-2 fas fa-plus"></i></button>
                    <button type="button" id="btnNewemailInfo" class="btn btn-info btn-sm" data-bs-toggle="modal" data-bs-target="#emailInfoModal" data-cert-flag="email">Email info<i class="mx-2 fas fa-plus"></i></button>
                    <table
                    id="cert_tbl"
                    data-side-pagination="server"
                    data-toggle="table"
                    data-pagination="true"
                    data-page-size="5"
                    data-search="false"
                    data-query-params="queryParams"
                    data-response-handler="responseHandler_cert"
                    data-detail-formatter="detailFormatter_cert"
                    data-detail-view="true"
                    data-detail-view-icon="true"
                    >
                        <thead>
                            <tr>
                                <th data-field="datestamp" data-sortable="true">Datestamp</th>
                                <th data-field="category" data-sortable="true">Category</th>
                                <th data-field="operate" data-formatter="operateFormatter_cert" data-events="operateEvents_cert">Action</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>
    [[ if userMembership == 'Doctor':]]
    <div class="row mb-3 actions">
        <div class="col">
            <div class="row">
                <div class="col">
                    <h3 class="big-title bg-info">Follow-up</h3>
                </div>
            </div>
            <div class="row bg-right py-3">
                <div class="col">
                    <form id="folForm" enctype="multipart/form-data" method="POST"> 
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col">
                                    <div class="input-group">
                                        <button id="folFormSubmit" type="submit" class="btn btn-secondary">Update<i class="mx-2 fas fa-plus"></i></button>
                                        <textarea class="form-control" aria-label="With textarea" name="description">[[ = XML(followup['description']) ]]</textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <input id="idfol" type="text" class="visually-hidden" name="id" value="[[ = XML(followup['id']) ]]"/>
                        <input id="idPatientfol" type="text" class="visually-hidden" name="id_auth_user" value="[[=patientId]]"/>
                        <input id="idWlfol" type="text" class="visually-hidden" name="id_worklist" value="[[=wlId]]"/>
                    </form>
                </div>
            </div>
        </div>
    </div>
    [[ pass ]]
</div>

[[ if userMembership == 'Doctor':]]
<div id="bill-container" class="container-fluid mb-3"> <!-- container billing -->
    <div class="row mb-3 big-title bg-success">
        <div class="col">
            <h2><a role="button" data-bs-toggle="collapse" href=".bill">Billing</a></h2>
        </div>
    </div>
    <div class="row mb-3 bill">
        <div class="col">
            <div class="row">
                <div class="col">
                    <div class="row">
                        <div class="col">
                            <h3 class="title-right">Right eye</h3>
                        </div>
                    </div>
                    <div class="row bg-right">
                        <div class="col">
                            Billing right eye
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="row">
                        <div class="col">
                            <h3 class="title-left">Left eye</h3>
                        </div>
                    </div>
                    <div class="row bg-left">
                        <div class="col">
                            Billing left eye
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="row">
                        <div class="col">
                            <h3 class="title-right">General</h3>
                        </div>
                    </div>
                    <div class="row bg-right py-3">
                        <div class="col">
                            <form id="bilForm" enctype="multipart/form-data" method="POST"> 
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col">
                                            <div class="input-group">
                                                <button id="bilFormSubmit" type="submit" class="btn btn-secondary">Update<i class="mx-2 fas fa-plus"></i></button>
                                                <textarea class="form-control" aria-label="With textarea" name="description">[[ = XML(billing['description']) ]]</textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <input id="idbil" type="text" class="visually-hidden" name="id" value="[[ = XML(billing['id']) ]]"/>
                                <input id="idPatientbil" type="text" class="visually-hidden" name="id_auth_user" value="[[=patientId]]"/>
                                <input id="idWlbil" type="text" class="visually-hidden" name="id_worklist" value="[[=wlId]]"/>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <h2 class="big-title bg-left"><a role="button" data-bs-toggle="collapse" href=".working">Working</a></h2>
                    <div class="row working">
                        <div class="col bg-left">
                            <h4 class="title-right">Billing</h4>
                            <div id="toolbar-wlCodes">
                                <button type="button" id="btnNewBillCode" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#billingModal" data-category-flag="billing">Add billing code<i class="mx-2 fas fa-plus"></i>
                                </button>
                            </div>
                            <table
                                id="wlCodes_tbl"
                                data-toolbar="#toolbar-wlCodes"
                                data-side-pagination="server"
                                data-toggle="table"
                                data-pagination="true"
                                data-page-size="10"
                                data-show-columns="true"
                                data-search="false"
                                data-search-accent-neutralise="true"
                                data-visible-search="false"
                                data-query-params="queryParams"
                                data-response-handler="responseHandler_wlCodes"
                                data-detail-formatter="detailFormatter_wlCodes"
                                data-detail-view="true"
                                data-detail-view-icon="true"
                                data-show-refresh="true"
                                data-show-footer="false"
                                >
                                <thead>
                                    <tr>
                                        <th data-field="date" data-sortable="true">Date</th>
                                        <th data-field="code" data-sortable="true">Code</th>
                                        <th data-field="combo" data-sortable="false">Combo</th>
                                        <th data-field="laterality" data-sortable="false">Laterality</th>
                                        <th data-field="lastprescribed" data-sortable="false">Last precribed</th>
                                        <th data-field="inami" data-sortable="false">INAMI</th>
                                        <th data-field="i1600" data-sortable="false">Std coverage</th>
                                        <th data-field="i1300" data-sortable="false">Benef coverage</th>
                                        <th data-field="priceTag" data-sortable="false">Price</th>
                                        <th data-field="note" data-sortable="false">Note</th>
                                        <th data-field="status" data-sortable="false">Status</th>
                                        <th data-field="operate" data-formatter="operateFormatter_wlCodes" data-events="operateEvents_wlCodes">Action
                                        </th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row mb-3 bill">
        <div class="col">
            <div class="row">
                <div class="col">
                    <h3 class="title-right">Recap</h3>
                </div>
            </div>
            <div class="row">
                <div class="col bg-right">
                    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Facilis deleniti dolor vitae libero a doloremque nobis quo quidem incidunt non suscipit molestiae odit velit obcaecati pariatur, porro explicabo laborum? Impedit!</p>
                </div>
            </div>
        </div>
    </div>
</div>
[[ pass ]]
<!-- Modal mxModal -->
<div class="modal fade" id="mxModal" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">New medication</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <div class="row">
                        <div class="col">
                            <form id="mxFormModal" enctype="multipart/form-data" method="POST">
                                <div class="container-fluid">
                                    <div class="row mb-3">
                                        <div class="col">
                                            <span class="form-label">Side:</span>
                                            <div class="input-group">
                                                <div class="btn-group mxdelivery_modal">
                                                    <input type="radio" id="mxdelivery_right_modal" name="delivery" class="btn-check" value="right" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="mxdelivery_right_modal">Right</label>
                                                    <input type="radio" id="mxdelivery_left_modal" name="delivery" class="btn-check" value="left" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="mxdelivery_left_modal">Left</label>
                                                    <input type="radio" id="mxdelivery_both_modal" name="delivery" class="btn-check" value="both" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="mxdelivery_both_modal">Both</label>
                                                    <input type="radio" id="mxdelivery_po_modal" name="delivery" class="btn-check" value="PO" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="mxdelivery_po_modal">PO</label>
                                                    <input type="radio" id="mxdelivery_local_modal" name="delivery" class="btn-check" value="local" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="mxdelivery_local_modal">Local</label>
                                                    <input type="radio" id="mxdelivery_iv_modal" name="delivery" class="btn-check" value="IV" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="mxdelivery_iv_modal">IV</label>
                                                    <input type="radio" id="mxdelivery_im_modal" name="delivery" class="btn-check" value="IM" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="mxdelivery_im_modal">IM</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col">
                                            <label for="mxOnset" class="form-label">Onset:</label>
                                            <input id="mxOnset" type="date" step="1" class="form-control"
                                                name="onset">
                                            <div id="mxOnsetHelp" class="form-text">Adjust onset</div>
                                        </div>
                                        <div class="col">
                                            <label for="mxEnded" class="form-label">End:</label>
                                            <input id="mxEnded" type="date" step="1" class="form-control" name="ended">
                                            <div id="mxEndedHelp" class="form-text">Adjust end date</div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label for="medicModal" class="form-label">Medication:</label>
                                            <input id="medicModal" type="text" class="form-control" name="medication" autocomplete="off">
                                            <div id="medicModalHelp" class="form-text">Enter medication name</div>
                                        </div>
                                        <div class="col-2">
                                            <label for="intake_modal" class="form-label">Intake:</label>
                                            <div class="input-group mb-3">
                                                <button class="btn btn-outline-secondary counter_down_intake" type="button">-</button>
                                                <input type="text" class="form-control form-control-sm intake_modal counter_intake text-center" value="1.00" aria-label="Intake" name="unit_per_intake" id="intake_modal">
                                                <button class="btn btn-outline-secondary counter_up_intake" type="button">+</button>
                                            </div>
                                        </div>
                                        <div class="col">
                                            <label for="freqModal" class="form-label">Frequency:</label>
                                            <input id="freqModal" type="text" class="form-control" name="frequency" autocomplete="off">
                                            <div id="freqModalHelp" class="form-text">Enter frequency</div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label for="mxNoteModal" class="form-label">Note:</label>
                                            <input id="mxNoteModal" type="text" class="form-control" name="note" autocomplete="off">
                                            <div id="mxNoteModalHelp" class="form-text">Note</div>
                                        </div>
                                    </div>
                                </div>
                                <input id="idMx" type="text" class="visually-hidden" name="id_medic_ref" />
                                <input id="idMxWl" type="text" class="visually-hidden" name="id_worklist" value="[[=wlId]]" />
                                <input id="idMxPrescribed" type="text" class="visually-hidden" name="prescribed" />
                                <input id="idMxRow" type="text" class="visually-hidden" name="id" />
                                <input id="idPatientRx" type="text" class="visually-hidden" name="id_auth_user" />
                                <input id="methodMxModalSubmit" type="text" class="visually-hidden" name="methodMxModalSubmit" value="POST" />
                                <input id="btnMxModalSubmit" type="submit" class="visually-hidden" />
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <label id="mxModalSubmit" for="btnMxModalSubmit" class="btn btn-primary" tabindex="0">Submit</label>
            </div>
        </div>
    </div>
</div>

<!-- Modal axModal -->
<div class="modal fade" id="axModal" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">New allergy</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <div class="row">
                        <div class="col">
                            <form id="axFormModal" enctype="multipart/form-data" method="POST">
                                <div class="container-fluid">
                                    <div class="row mb-3">
                                        <div class="col">
                                            <span class="form-label">Type:</s>
                                            <div class="input-group">
                                                <div class="btn-group typ_modal">
                                                    <input type="radio" id="typ_allergy_modal" name="typ" class="btn-check" value="allergy" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="typ_allergy_modal">Allergy</label>
                                                    <input type="radio" id="typ_atopy_modal" name="typ" class="btn-check" value="atopy" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="typ_atopy_modal">Atopy</label>
                                                    <input type="radio" id="typ_intolerance_modal" name="typ" class="btn-check" value="intolerance" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="typ_intolerance_modal">Intolerance</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col">
                                            <label for="axOnset" class="form-label">Onset:</label>
                                            <input id="axOnset" type="date" step="1" class="form-control"
                                                name="onset">
                                            <div id="axOnsetHelp" class="form-text">Adjust onset</div>
                                        </div>
                                        <div class="col">
                                            <label for="axEnded" class="form-label">End:</label>
                                            <input id="axEnded" type="date" step="1" class="form-control" name="ended">
                                            <div id="axEndedHelp" class="form-text">Adjust end date</div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label for="agentModal" class="form-label">Agent:</label>
                                            <input id="agentModal" type="text" class="form-control" name="agent" autocomplete="off">
                                            <div id="medicModalHelp" class="form-text">Enter agent name</div>
                                        </div>
                                    </div>
                                </div>
                                <input id="idAgent" type="text" class="visually-hidden" name="id_agent" />
                                <input id="idAxRow" type="text" class="visually-hidden" name="id" />
                                <input id="idPatientAx" type="text" class="visually-hidden" name="id_auth_user" />
                                <input id="methodAxModalSubmit" type="text" class="visually-hidden" name="methodAxModalSubmit" value="POST" />
                                <input id="btnAxModalSubmit" type="submit" class="visually-hidden" />
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <label id="axModalSubmit" for="btnAxModalSubmit" class="btn btn-primary" tabindex="0">Submit</label>
            </div>
        </div>
    </div>
</div>

<!-- Modal mHxModal -->
<div class="modal fade" id="mHxModal" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">New medical history</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <div class="row">
                        <div class="col">
                            <form id="mHxFormModal" enctype="multipart/form-data" method="POST">
                                <div class="container-fluid">
                                    <div class="row mb-3">
                                        <div class="col">
                                            <span class="form-label">Category:</span>
                                            <div class="input-group">
                                                <div class="btn-group category_modal">
                                                    <input type="radio" id="mHxcategory_medical_modal" name="category" class="btn-check" value="medical" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="mHxcategory_medical_modal">Medical</label>
                                                    <input type="radio" id="mHxcategory_surgical_modal" name="category" class="btn-check" value="surgical" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="mHxcategory_surgical_modal">Surgical</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col">
                                            <span class="form-label">Site:</span>
                                            <div class="input-group">
                                                <div class="btn-group site_modal">
                                                    <input type="radio" id="mHxsite_right_modal" name="site" class="btn-check" value="right" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="mHxsite_right_modal">Right</label>
                                                    <input type="radio" id="mHxsite_left_modal" name="site" class="btn-check" value="left" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="mHxsite_left_modal">Left</label>
                                                    <input type="radio" id="mHxsite_both_modal" name="site" class="btn-check" value="both" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="mHxsite_both_modal">Both</label>
                                                    <input type="radio" id="mHxsite_local_modal" name="site" class="btn-check" value="local" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="mHxsite_local_modal">Local</label>
                                                    <input type="radio" id="mHxsite_systemic_modal" name="site" class="btn-check" value="systemic" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="mHxsite_systemic_modal">Systemic</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label for="mHxOnset" class="form-label">Onset:</label>
                                            <input id="mHxOnset" type="date" step="1" class="form-control"
                                                name="onset">
                                            <div id="mHxOnsetHelp" class="form-text">Adjust onset</div>
                                        </div>
                                        <div class="col">
                                            <label for="mHxEnded" class="form-label">End:</label>
                                            <input id="mHxEnded" type="date" step="1" class="form-control" name="ended">
                                            <div id="mHxEndedHelp" class="form-text">Adjust end date</div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label for="mHxtitleModal" class="form-label">Title:</label>
                                            <input id="mHxtitleModal" type="text" class="form-control" name="title" autocomplete="off">
                                            <div id="mHxtitleModalHelp" class="form-text">Enter disease title</div>
                                        </div>
                                        <div class="col">
                                            <label for="mHxnoteModal" class="form-label">Note:</label>
                                            <input id="mHxnoteModal" type="text" class="form-control" name="note" autocomplete="off">
                                            <div id="mHxnoteModalHelp" class="form-text">Note</div>
                                        </div>
                                    </div>
                                </div>
                                <input id="idDiseaseRef" type="text" class="visually-hidden" name="id_disease_ref" />
                                <input id="idmHxRow" type="text" class="visually-hidden" name="id" />
                                <input id="idmHxWl" type="text" class="visually-hidden" name="id_worklist" />
                                <input id="idPatientmHx" type="text" class="visually-hidden" name="id_auth_user" />
                                <input id="methodmHxModalSubmit" type="text" class="visually-hidden" name="methodmHxModalSubmit" value="POST" />
                                <input id="btnmHxModalSubmit" type="submit" class="visually-hidden" />
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <label id="mHxModalSubmit" for="btnmHxModalSubmit" class="btn btn-primary" tabindex="0">Submit</label>
            </div>
        </div>
    </div>
</div>

<!-- Modal mxRxModal -->
<div class="modal fade" id="mxRxModal" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Prescription module</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="visually-hidden"><canvas id="itf"></canvas></div>
                <div class="container">
                    <div class="row">
                        <div class="col">
                            <table class="table">
                                <thead>
                                  <tr>
                                    <th scope="col">Medication</th>
                                    <th scope="col">Posology</th>
                                    <th scope="col">Onset</th>
                                    <th scope="col">End</th>
                                  </tr>
                                </thead>
                                <tbody id="mxRxTd">
                                    <!-- insert rows <td></td>-->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" id="mxRxModalPrint" class="btn btn-primary">Print</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal GxRxModal -->
<div class="modal fade" id="GxRxModal" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Glass module</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <div class="row">
                        <div class="col">
                            <div class="row">
                                <div class="col title-right">
                                    <h4>Rx Right eye</h4>
                                </div>
                            </div>
                            <div class="row bg-right">
                                <div class="col">
                                    <table class="table right">
                                        <thead>
                                          <tr>
                                            <th scope="col">Origin</th>  
                                            <th scope="col">Type</th>
                                            <th scope="col">Rx</th>
                                            <th scope="col"></th>
                                          </tr>
                                        </thead>
                                        <tbody id="GxRxRTd">
                                            <!-- insert rows <td></td>-->
                                        </tbody>
                                    </table> 
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <div class="row">
                                <div class="col title-left">
                                    <h4>Rx Left eye</h4>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col bg-left">
                                    <table class="table left">
                                        <thead>
                                          <tr>
                                            <th scope="col">Origin</th>  
                                            <th scope="col">Type</th>
                                            <th scope="col">Rx</th>
                                            <th scope="col"></th>
                                          </tr>
                                        </thead>
                                        <tbody id="GxRxLTd">
                                            <!-- insert rows <td></td>-->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div> <!-- end table row-->
                    <div class="row mt-3">
                        <div class="col">
                            <div class="row">
                                <div class="col title-right">
                                    <h4>Rx Right to prescribe</h4>
                                </div>
                            </div>
                            <div class="row bg-right">
                                <div class="col">
                                    <table class="table right">
                                        <thead>
                                          <tr>
                                            <th scope="col">Origin</th>  
                                            <th scope="col">Type</th>
                                            <th scope="col">Rx</th>
                                            <th scope="col"></th>
                                          </tr>
                                        </thead>
                                        <tbody id="GxRxright">
                                            <!-- insert rows <td></td>-->
                                        </tbody>
                                    </table> 
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <div class="row">
                                <div class="col title-left">
                                    <h4>Rx Left eye to prescribe</h4>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col bg-left">
                                    <table class="table left">
                                        <thead>
                                          <tr>
                                            <th scope="col">Origin</th>  
                                            <th scope="col">Type</th>
                                            <th scope="col">Rx</th>
                                            <th scope="col"></th>
                                          </tr>
                                        </thead>
                                        <tbody id="GxRxleft">
                                            <!-- insert rows <td></td>-->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div> <!-- end table row-->
                    <div class="row mb-3">
                        <div class="col">
                            <form id="GxRxFormModal">
                                <div class="container-fluid">
                                    <div class="row mb-3">
                                        <div class="col" id="modalTypeDiv">
                                            <span class="form-label">Glass type:</span>
                                            <div class="input-group">
                                                <div class="btn-group glass_type_modal">
                                                    <input type="radio" id="glass_type_monofar_modal" name="glass_type" class="btn-check" value="monofocalfar" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="glass_type_monofar_modal">Monofocal far</label>
                                                    <input type="radio" id="glass_type_monoclose_modal" name="glass_type" class="btn-check" value="monofocalclose" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="glass_type_monoclose_modal">Monofocal close</label>
                                                    <input type="radio" id="glass_type_prog_modal" name="glass_type" class="btn-check" value="progressive" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="glass_type_prog_modal">Progressive</label>
                                                    <input type="radio" id="glass_type_bif_modal" name="glass_type" class="btn-check" value="bifocal" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="glass_type_bif_modal">Bifocal</label>
                                                    <input type="radio" id="glass_type_deg_modal" name="glass_type" class="btn-check" value="degressive" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="glass_type_deg_modal">Degressive</label>
                                                    <input type="radio" id="glass_type_na" name="glass_type" class="btn-check visually-hidden" value="na" autocomplete="off">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col" id="art30Div">
                                            <span class="form-label">Article 30:</span>
                                            <div class="input-group">
                                                <div class="btn-group art30_modal">
                                                    <input type="radio" id="art30_no_modal" name="art30" class="btn-check"  value="False" autocomplete="off" checked>
                                                    <label class="btn btn-outline-primary" for="art30_no_modal">No</label>
                                                    <input type="radio" id="art30_yes_modal" name="art30" class="btn-check" value="True" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="art30_yes_modal">Yes</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label for="GxHxremarksModal" class="form-label">Remarks:</label>
                                            <input id="GxHxremarksModal" type="text" class="form-control" name="remarks" autocomplete="off">
                                            <div id="GxHxremarksModalHelp" class="form-text">Enter remarks including related to prism</div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col bg-right">
                                            <div class="row">
                                                <div class="col">
                                                    <label for="GxHxprismRModal" class="form-label">Prism right:</label>
                                                    <input id="GxHxprismRModal" type="number" class="form-control" name="prismR" autocomplete="off">
                                                    <div id="GxHprismRModalHelp" class="form-text">Enter prismvalue right in diopters</div>
                                                </div>
                                                <div class="col">
                                                    <label for="GxHxbaseRModal" class="form-label">Base right:</label>
                                                    <input id="GxHxbaseRModal" type="text" class="form-control" name="baseR" autocomplete="off">
                                                    <div id="GxHbaseRModalHelp" class="form-text">Enter base direction</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col bg-left">
                                            <div class="row">
                                                <div class="col">
                                                    <label for="GxHxprismLModal" class="form-label">Prism left:</label>
                                                    <input id="GxHxprismLModal" type="number" class="form-control" name="prismL" autocomplete="off">
                                                    <div id="GxHprismLModalHelp" class="form-text">Enter prismvalue left in diopters</div>
                                                </div>
                                                <div class="col">
                                                    <label for="GxHxbaseLModal" class="form-label">Prism left:</label>
                                                    <input id="GxHxbaseLModal" type="text" class="form-control" name="baseL" autocomplete="off">
                                                    <div id="GxHbaseLModalHelp" class="form-text">Enter base direction</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col" id="tintDiv">
                                            <span class="form-label">Tint:</span>
                                            <div class="input-group">
                                                <div class="btn-group tint_modal">
                                                    <input type="radio" id="tint_no_modal" name="tint" class="btn-check" value="" autocomplete="off" checked>
                                                    <label class="btn btn-outline-primary" for="tint_no_modal">No</label>
                                                    <input type="radio" id="tint_notmedical_modal" name="tint" class="btn-check" value="False" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="tint_notmedical_modal">Non medical</label>
                                                    <input type="radio" id="tint_medical_modal" name="tint" class="btn-check" value="True" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="tint_medical_modal">Medical</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col" id="tintDiv">
                                            <span class="form-label">Photochromic:</span>
                                            <div class="input-group">
                                                <div class="btn-group photo_modal">
                                                    <input type="radio" id="photo_no_modal" name="photo" class="btn-check" value="" autocomplete="off" checked>
                                                    <label class="btn btn-outline-primary" for="photo_no_modal">No</label>
                                                    <input type="radio" id="photo_notmedical_modal" name="photo" class="btn-check" value="False" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="photo_notmedical_modal">Non medical</label>
                                                    <input type="radio" id="photo_medical_modal" name="photo" class="btn-check" value="True" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="photo_medical_modal">Medical</label>                                                    
                                                </div>
                                            </div>
                                        </div>                                        
                                    </div>
                                </div>
                                <input id="idGxHxWl" type="text" class="visually-hidden" name="id_worklist" />
                                <input id="idPatientGxHx" type="text" class="visually-hidden" name="id_auth_user" />
                                <input id="methodGxHxModalSubmit" type="text" class="visually-hidden" name="methodGxHxModalSubmit" value="POST" />
                                <input id="btnGxRxModalSubmit" type="submit" class="visually-hidden" />
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <label id="GxRxModalSubmit" for="btnGxRxModalSubmit" class="btn btn-primary" tabindex="0">Print</label>
            </div>
        </div>
    </div>
</div>

<!-- Modal CxRxModal -->
<div class="modal fade" id="CxRxModal" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Contact lenses module</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <div class="row">
                        <div class="col">
                            <div class="row">
                                <div class="col title-right">
                                    <h4>Rx Right eye</h4>
                                </div>
                            </div>
                            <div class="row bg-right">
                                <div class="col">
                                    <table class="table right">
                                        <thead>
                                          <tr>
                                            <th scope="col">Origin</th>  
                                            <th scope="col">Type</th>
                                            <th scope="col">Rx</th>
                                            <th scope="col"></th>
                                          </tr>
                                        </thead>
                                        <tbody id="CxRxRTd">
                                            <!-- insert rows <td></td>-->
                                        </tbody>
                                    </table> 
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <div class="row">
                                <div class="col title-left">
                                    <h4>Rx Left eye</h4>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col bg-left">
                                    <table class="table left">
                                        <thead>
                                          <tr>
                                            <th scope="col">Origin</th>  
                                            <th scope="col">Type</th>
                                            <th scope="col">Rx</th>
                                            <th scope="col"></th>
                                          </tr>
                                        </thead>
                                        <tbody id="CxRxLTd">
                                            <!-- insert rows <td></td>-->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div> <!-- end table row-->
                    <div class="row mt-3">
                        <div class="col">
                            <div class="row">
                                <div class="col title-right">
                                    <h4>Rx Right to prescribe</h4>
                                </div>
                            </div>
                            <div class="row bg-right">
                                <div class="col">
                                    <table class="table right">
                                        <thead>
                                          <tr>
                                            <th scope="col">Origin</th>  
                                            <th scope="col">Type</th>
                                            <th scope="col">Rx</th>
                                            <th scope="col"></th>
                                          </tr>
                                        </thead>
                                        <tbody id="CxRxright">
                                            <!-- insert rows <td></td>-->
                                        </tbody>
                                    </table> 
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <div class="row">
                                <div class="col title-left">
                                    <h4>Rx Left eye to prescribe</h4>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col bg-left">
                                    <table class="table left">
                                        <thead>
                                          <tr>
                                            <th scope="col">Origin</th>  
                                            <th scope="col">Type</th>
                                            <th scope="col">Rx</th>
                                            <th scope="col"></th>
                                          </tr>
                                        </thead>
                                        <tbody id="CxRxleft">
                                            <!-- insert rows <td></td>-->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div> <!-- end table row-->
                    <div class="row mb-3">
                        <div class="col">
                            <form id="CxRxFormModal">
                                <div class="container-fluid">
                                    <div class="row my-2">
                                        <h4 class="big-title bg-neutral">Contact lenses prescription</h4>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col bg-right">
                                            <div class="row">
                                                <h5 class="title-right">Right contact</h5>
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <div class="form-floating mb-3">
                                                        <input type="number" step="0.25" class="form-control" id="sphR_lc" placeholder="Sphere" name="sphR">
                                                        <label for="sphR_lc">Sphere</label>
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <div class="form-floating mb-3">
                                                        <input type="number" step="0.25" class="form-control" id="cylR_lc" placeholder="Cylinder" name="cylR">
                                                        <label for="cylR_lc">Cylinder</label>
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <div class="form-floating mb-3">
                                                        <input type="number" step="0.25" class="form-control" id="axisR_lc" placeholder="Axis" name="axisR">
                                                        <label for="axisR_lc">Axis</label>
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <div class="form-floating mb-3">
                                                        <input type="number" step="0.25" min="0" value="0" class="form-control" id="addR_lc" placeholder="Addition" name="addcR">
                                                        <label for="addR_lc">Add</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <label for="lensnameRModal" class="form-label">Lens:</label>
                                                    <input id="lensnameRModal" type="text" class="form-control" name="lensnameR" autocomplete="off">
                                                    <div id="lensnameRModalHelp" class="form-text">Choose lens</div>                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <div class="form-floating mb-3">
                                                        <input type="number" step="0.05" class="form-control" id="basecurveR_lc" placeholder="Base curve" name="basecurveR">
                                                        <label for="basecurveR_lc">Base curve</label>
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <div class="form-floating mb-3">
                                                        <input type="number" step="0.10" class="form-control" id="diameterR_lc" placeholder="Diameter" name="diameterR">
                                                        <label for="diameterR_lc">Diameter</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col bg-left">
                                            <div class="row">
                                                <h5 class="title-left">Left contact</h5>
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <div class="form-floating mb-3">
                                                        <input type="number" step="0.25" class="form-control" id="sphL_lc" placeholder="Sphere" name="sphL">
                                                        <label for="sphL_lc">Sphere</label>
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <div class="form-floating mb-3">
                                                        <input type="number" step="0.25" class="form-control" id="cylL_lc" placeholder="Cylinder" name="cylL">
                                                        <label for="cylL_lc">Cylinder</label>
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <div class="form-floating mb-3">
                                                        <input type="number" step="0.25" class="form-control" id="axisL_lc" placeholder="Axis" name="axisL">
                                                        <label for="axisL_lc">Axis</label>
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <div class="form-floating mb-3">
                                                        <input type="number" step="0.25" min="0" value="0" class="form-control" id="addL_lc" placeholder="Addition" name="addcL">
                                                        <label for="addL_lc">Add</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <label for="lensnameLModal" class="form-label">Lens:</label>
                                                    <input id="lensnameLModal" type="text" class="form-control" name="lensnameL" autocomplete="off">
                                                    <div id="lensnameLModalHelp" class="form-text">Choose lens</div>                                                    
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <div class="form-floating mb-3">
                                                        <input type="number" step="0.05" class="form-control" id="basecurveL_lc" placeholder="Base curve" name="basecurveL">
                                                        <label for="basecurveL_lc">Base curve</label>
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <div class="form-floating mb-3">
                                                        <input type="number" step="0.10" class="form-control" id="diameterL_lc" placeholder="Diameter" name="diameterL">
                                                        <label for="diameterL_lc">Diameter</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col bg-right">
                                            <label for="CxRxcleaningRModal" class="form-label">Right cleaning solution:</label>
                                            <input id="CxRxcleaningRModal" type="text" class="form-control" name="cleaningR" autocomplete="off">
                                            <div id="CxRxcleaningRModalHelp" class="form-text">Enter cleaning solution</div>
                                        </div>
                                        <div class="col bg-left">
                                            <label for="CxRxcleaningLModal" class="form-label">Left cleaning solution:</label>
                                            <input id="CxRxcleaningLModal" type="text" class="form-control" name="cleaningL" autocomplete="off">
                                            <div id="CxRxcleaningLModalHelp" class="form-text">Enter cleaning solution</div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col" id="group-1">
                                            <h6 class="big-title bg-neutral">Group 1 contact lenses</h6>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="checkbox" name="g1sspheric" id="g1sspheric">
                                                <label class="form-check-label" for="g1sspheric">
                                                    Soft spheric contact lenses
                                                </label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="checkbox" name="g1storic" id="g1storic">
                                                <label class="form-check-label" for="g1storic">
                                                    Soft toric contact lenses
                                                </label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="checkbox" name="g1rspheric" id="g1rspheric">
                                                <label class="form-check-label" for="g1rspheric">
                                                    Rigid spheric contact lenses
                                                </label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="checkbox" name="g1rtoric" id="g1rtoric">
                                                <label class="form-check-label" for="g1rtoric">
                                                    Rigid toric contact lenses
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col" id="group-2">
                                            <h6 class="big-title bg-neutral">Group 2 irregular cornea</h6>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="checkbox" name="g2soft" id="g2soft">
                                                <label class="form-check-label" for="g2soft">
                                                    Soft or hybrid
                                                </label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="checkbox" name="g2rigidc" id="g2rigidc">
                                                <label class="form-check-label" for="g2rigidc">
                                                    Rigid corneal
                                                </label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="checkbox" name="g2rigidcs" id="g2rigidcs">
                                                <label class="form-check-label" for="g2rigidcs">
                                                    Rigid corneo-scleral
                                                </label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="checkbox" name="g2rigids" id="g2rigids">
                                                <label class="form-check-label" for="g2rigids">
                                                    Rigid scleral
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col" id="group-3">
                                            <h6 class="big-title bg-neutral">Group 3 special</h6>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="checkbox" name="g3iris" id="g3iris">
                                                <label class="form-check-label" for="g3iris">
                                                    Soft with opaque iris
                                                </label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="checkbox" name="g3pupil" id="g3pupil">
                                                <label class="form-check-label" for="g3pupil">
                                                    Soft with opaque pupil
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col" id="art30CDiv">
                                            <span class="form-label">Article 30:</span>
                                            <div class="input-group">
                                                <div class="btn-group art30C_modal">
                                                    <input type="radio" id="art30C_no_modal" name="art30" class="btn-check"  value="False" autocomplete="off" checked>
                                                    <label class="btn btn-outline-primary" for="art30C_no_modal">No</label>
                                                    <input type="radio" id="art30C_yes_modal" name="art30" class="btn-check" value="True" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="art30C_yes_modal">Yes</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label for="CxRxremarksModal" class="form-label">Remarks:</label>
                                            <input id="CxRxremarksModal" type="text" class="form-control" name="remarks" autocomplete="off">
                                            <div id="CxRxremarksModalHelp" class="form-text">Enter remarks concerning contact lenses adaptation</div>
                                        </div>
                                    </div>                                    
                                </div>
                                <input id="CxRxmaterialR" type="text" class="visually-hidden" name="materialR" />
                                <input id="CxRxmaterialL" type="text" class="visually-hidden" name="materialL" />
                                <input id="CxRxdesignR" type="text" class="visually-hidden" name="designR" />
                                <input id="CxRxdesignL" type="text" class="visually-hidden" name="designL" />
                                <input id="CxRxedgeR" type="text" class="visually-hidden" name="edgeR" />
                                <input id="CxRxedgeL" type="text" class="visually-hidden" name="edgeL" />
                                <input id="CxRxopticalzoneR" type="text" class="visually-hidden" name="opticalzoneR" />
                                <input id="CxRxopticalzoneL" type="text" class="visually-hidden" name="opticalzoneL" />
                                <input id="idCxRxWl" type="text" class="visually-hidden" name="id_worklist" />
                                <input id="idPatientCxRx" type="text" class="visually-hidden" name="id_auth_user" />
                                <input id="methodCxRxModalSubmit" type="text" class="visually-hidden" name="methodCxRxModalSubmit" value="POST" />
                                <input id="btnCxRxModalSubmit" type="submit" class="visually-hidden" />
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <label id="CxRxModalSubmit" for="btnCxRxModalSubmit" class="btn btn-primary" tabindex="0">Print</label>
            </div>
        </div>
    </div>
</div>

<!-- Modal certificateModal -->
<div class="modal fade" id="certificateModal" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Certificate module</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <form id="certificateFormModal">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col">
                                    <textarea name="content" id="certificateContent">
                                    </textarea>
                                </div>
                            </div>
                        </div>
                        <input id="certificateCat" type="text" class="visually-hidden" name="category" />
                        <input id="certificateDest" type="text" class="visually-hidden" name="destination" />
                        <input id="certificateTitle" type="text" class="visually-hidden" name="title" />
                        <input id="certificateOnset" type="text" class="visually-hidden" name="onset" />
                        <input id="certificateEnded" type="text" class="visually-hidden" name="ended" />
                        <input id="idcertificateWl" type="text" class="visually-hidden" name="id_worklist" />
                        <input id="idPatientcertificate" type="text" class="visually-hidden" name="id_auth_user" />
                        <input id="methodcertificateModalSubmit" type="text" class="visually-hidden" name="methodcertificateModalSubmit" value="POST" />
                        <input id="btncertificateModalSubmit" type="submit" class="visually-hidden" />
                    </form>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <label id="certificateModalSubmit" for="btncertificateModalSubmit" class="btn btn-primary" tabindex="0">Print</label>
            </div>
        </div>
    </div>
</div>

<!-- Modal sickModal -->
<div class="modal fade" id="sickModal" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Sick leave module</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <form id="sickFormModal">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col">
                                    <label for="onsetsick" class="form-label">Onset:</label>
                                    <input id="onsetsick" type="date" step="1" class="form-control" name="onset">
                                    <div id="onsetsickHelp" class="form-text">Sick leave onset</div>
                                </div>
                                <div class="col">
                                    <label for="endedsick" class="form-label">End:</label>
                                    <input id="endedsick" type="date" step="1" class="form-control" name="ended">
                                    <div id="endedsickHelp" class="form-text">Sick leave end</div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <span class="form-label">Exit allowance:</span>
                                    <div class="input-group">
                                        <div class="btn-group laterality">                                                
                                            <input type="radio" id="exit_yes" name="exit" class="btn-check" value="yes" autocomplete="off" checked>
                                            <label class="btn btn-outline-success" for="exit_yes">Yes</label>
                                            <input type="radio" id="exit_no" name="exit" class="btn-check" value="no" autocomplete="off">
                                            <label class="btn btn-outline-danger" for="exit_no">No</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button class="btn btn-primary" data-bs-target="#certificateModal" data-bs-toggle="modal" data-bs-dismiss="modal" data-cert-flag="sick">Edit</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal emailInfoModal -->
<div class="modal fade" id="emailInfoModal" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Email module</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <form id="emailInfoFormModal">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col">
                                    <textarea name="content" id="emailContent">
                                    </textarea>
                                </div>
                            </div>
                        </div>
                        <input id="emailCat" type="text" class="visually-hidden" name="category" />
                        <input id="emailDest" type="text" class="visually-hidden" name="destination" />
                        <input id="emailTitle" type="text" class="visually-hidden" name="title" />
                        <input id="emailOnset" type="text" class="visually-hidden" name="onset" />
                        <input id="emailEnded" type="text" class="visually-hidden" name="ended" />
                        <input id="idemailWl" type="text" class="visually-hidden" name="id_worklist" />
                        <input id="idPatientemail" type="text" class="visually-hidden" name="id_auth_user" />
                        <input id="methodcemailodalSubmit" type="text" class="visually-hidden" name="methodemailModalSubmit" value="POST" />
                        <input id="btnemailModalSubmit" type="submit" class="visually-hidden" />
                    </form>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <label id="emailModalSubmit" for="btnemailModalSubmit" class="btn btn-primary" tabindex="0">Send</label>
            </div>
        </div>
    </div>
</div>

<!-- Modal billingModal -->
<div class="modal fade" id="billingModal" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Billing codes entry</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <div class="row">
                        <div class="col">
                            <div id="comboCodeSelection" class="m-3">
                                <div class="mb-3">
                                    <label for="comboCodeSelect" class="form-label">Select Combo code</label>
                                    <select class="form-select" id="comboCodeSelect" required>
                                        <!-- Options will be populated here -->
                                    </select>
                                </div>
                                <button id="addComboBtn" class="btn btn-secondary">Add+</button>
                            </div>
                        
                            <!-- Code List Table -->
                            <div id="combo_listcode" class="m-3">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th scope="col">Code</th>
                                            <th scope="col">Description</th>
                                            <th scope="col">Price</th>
                                            <th scope="col">Covered</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Table rows will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="col">
                            <div class="row">
                                <div class="col">
                                    <div id="codeSelection" class="m-3">
                                        <div class="mb-3">
                                            <label for="codeSelect" class="form-label">Search code:</label>
                                            <input id="codeSelect" type="text" class="form-control" name="code" autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                                <div class="col">
                                    <div id="codeTextSelection" class="m-3">
                                        <div class="mb-3">
                                            <label for="codeTextSelect" class="form-label">Search text code:</label>
                                            <input id="codeTextSelect" type="text" class="form-control" name="codeText" autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <button id="addCodeBtn" class="btn btn-secondary">Add+</button>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                    <div id="listCodeDescription">
                                        <!-- Table rows will be populated here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <span class="form-label">Site:</span>
                            <div class="input-group">
                                <div class="btn-group site_modal">
                                    <input type="radio" id="billingsite_right_modal" name="site" class="btn-check" value="right" autocomplete="off">
                                    <label class="btn btn-outline-primary" for="billingsite_right_modal">Right</label>
                                    <input type="radio" id="billingsite_left_modal" name="site" class="btn-check" value="left" autocomplete="off">
                                    <label class="btn btn-outline-primary" for="billingsite_left_modal">Left</label>
                                    <input type="radio" id="billingsite_both_modal" name="site" class="btn-check" value="both" autocomplete="off" checked>
                                    <label class="btn btn-outline-primary" for="billingsite_both_modal">Both</label>
                                    <input type="radio" id="billingsite_local_modal" name="site" class="btn-check" value="local" autocomplete="off">
                                    <label class="btn btn-outline-primary" for="billingsite_local_modal">Local</label>
                                    <input type="radio" id="billingsite_systemic_modal" name="site" class="btn-check" value="systemic" autocomplete="off">
                                    <label class="btn btn-outline-primary" for="billingsite_systemic_modal">Systemic</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <form id="billingFormModal" enctype="multipart/form-data" method="POST">
                                <div class="container-fluid">
                                    <div class="row mb-3">
                                        <div class="col">
                                            
                                        </div>
                                    </div>
                                </div>
                                <input id="idBillingDate" type="date" class="visually-hidden" name="date" />
                                <input id="idBillingWl" type="text" class="visually-hidden" name="id_worklist" />
                                <input id="idPatientbilling" type="text" class="visually-hidden" name="id_auth_user" />
                                <input id="methodbillingModalSubmit" type="text" class="visually-hidden" name="methodbillingModalSubmit" value="POST" />
                                <input id="btnbillingModalSubmit" type="submit" class="visually-hidden" />
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <label id="billingModalSubmit" for="btnbillingModalSubmit" class="btn btn-primary" tabindex="0">Submit</label>
            </div>
        </div>
    </div>
</div>

<!-- cache offcanvas -->
<div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasCache" aria-labelledby="offcanvas cache">
    <div class="offcanvas-header">
      <button type="button" class="btn btn-primary" id="clearCache">Clear cache</button>
      <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
        <div class="row">
            <div class="col">
                <div class="row">
                    <h3 class="big-title">Rx selected</h3>
                </div>
                <div class="row">
                    <ul class="rxUl list-group">
                    </ul>
                </div>
                <div class="row">
                    <table class="table">
                        <thead>
                          <tr>
                            <th scope="col">Origin</th>
                            <th scope="col">Type</th>
                            <th scope="col">Rx</th>
                          </tr>
                        </thead>
                        <tbody class="rxTd">
                            <!-- insert rows <td></td>-->
                        </tbody>
                      </table>
                </div>
            </div>
        </div>
    </div> <!-- end offcanvas body-->
</div>

[[ block js_scripts]]

<script type="text/javascript">
// Global variables
const HOSTURL = "[[ = hosturl ]]";
var usermdObj = [[ =XML(mdParams) ]];
var userObj = [[ =XML(userDict)]];
const SUPPLEMENT_RATIO = [[ = XML(supplement_ratio)]]
const comboObj = [[ = XML(combos_json)]]

// for timer
var timer_id = [];
// modality controllers
var modalityDict = [[ = XML(modalityDict) ]];
let modalityController = '[[ = XML(modalityController) ]]';
// prescription objects
var rxObj = [], tonoObj = [] ;
var prescRxObj = {};
var axe64 = 'data:image/png;base64,'+'[[=XML(axe64)]]';
var logo64 ='data:image/jpg;base64,'+'[[=XML(logo64)]]';
// submit btn to disable when done
const btnArr = ['#btnTaskDone','#btnNewMx', '#btnNewAx','#btnNewmHx', '#btnNewsHx', 'input', 'textarea', '#btnNewCoding','#btnNewMxWl','#btnMxRx','#btnGxRx' ];

</script>
<script src="js/bootstrap-table_1.22/bootstrap-table.min.js"></script>
<script src="js/bootbox/bootbox.all.min.js"></script>
<script src="js/jquery.serialize-object.min.js"></script>
<!-- https://bootstrap-autocomplete.readthedocs.io/en/latest/ -->
<script src="js/bootstrap-autocomplete.min.js"></script> 
<script src="js/timer.jquery.min.js"></script>
<script src="js/useful.js"></script>
<script src="js/patient-bar.js"></script>
<script src="js/md_bt.js"></script>
<!-- pdfmake and template prescription -->
<script src="js/pdfmake/pdfmake.min.js"></script>
<script src="js/pdfmake/vfs_fonts.js"></script>
<script src="js/jsbarcode/JsBarcode.itf.min.js"></script>
<script src="js/html-to-pdfmake.js"></script>
<!-- tinymce -->
<script src="js/tinymce/tinymce.min.js"></script>
<script src="js/tinymce/jquery.tinymce.min.js"></script>
<script type="text/javascript">

// 
const API_MD = HOSTURL + "/"+APP_NAME+"/api/md?@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&id_worklist.eq="+wlId;

// TODO: to implement
// add keywd parameter & keyoptions eg 'frequency&keyoptions.contains=...' for autocomplete
const API_AUTODICT = HOSTURL + "/"+APP_NAME+"/api/auto_dict?@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&keywd.eq=";

// API_MEDICATION lists medications for autocomplete
const API_MEDICATIONS = HOSTURL + "/"+APP_NAME+"/api/medic_ref?@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true";
// API_AGENT lists agents for autocomplete
const API_AGENTS = HOSTURL + "/"+APP_NAME+"/api/agent?@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true";
// API_DISEASES lists diseases for autocomplete
const API_DISEASES = HOSTURL + "/"+APP_NAME+"/api/disease_ref?@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true";

// API_LENSES lists lenses for autocomplete
const API_LENSES = HOSTURL + "/"+APP_NAME+"/api/cl?@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true";

// API_CLEANING lists cleaning solutions for autocomplete
const API_CLEANING = HOSTURL + "/"+APP_NAME+"/api/cleaning_solution?@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true";

// API_NOMENCLATURE lists nomenclature codes for autocomplete
const API_NOMENCLATURE = HOSTURL + "/"+APP_NAME+"/api/nomenclature?@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true";


// table listing ALL medications taken by user
const API_MXUSER = HOSTURL + "/"+APP_NAME+"/api/mx?@lookup=medication!:id_medic_ref[id,name,brand,form],mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id&id_auth_user.eq=" + patientId;
var $mx_tbl = $('#mx_tbl').bootstrapTable({
    url: API_MXUSER
});

// table listing ALL allergy to agents by user
const API_AXUSER = HOSTURL + "/"+APP_NAME+"/api/allergy?@lookup=agentRef!:id_agent[id,name,code,description],mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id&id_auth_user.eq=" + patientId;
var $ax_tbl = $('#ax_tbl').bootstrapTable({
    url: API_AXUSER
});

// table listing medical history by user
const API_MHXUSER = HOSTURL + "/"+APP_NAME+"/api/phistory?category.eq=medical&@lookup=disease!:id_disease_ref[id,title,category,icd10],mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id&id_auth_user.eq=" + patientId;
var $mHx_tbl = $('#mHx_tbl').bootstrapTable({
    url: API_MHXUSER
});

// table listing surgical history by user
const API_SHXUSER = HOSTURL + "/"+APP_NAME+"/api/phistory?category.eq=surgical&@lookup=disease!:id_disease_ref[id,title,category,icd10],mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id&id_auth_user.eq=" + patientId;
var $sHx_tbl = $('#sHx_tbl').bootstrapTable({
    url: API_SHXUSER
});

// table listing ocular history by user
const API_OHXUSER = HOSTURL + "/"+APP_NAME+"/api/phistory?site.in=right,left,both&@lookup=disease!:id_disease_ref[id,title,category,icd10],mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id&id_auth_user.eq=" + patientId;
var $oHx_tbl = $('#oHx_tbl').bootstrapTable({
    url: API_OHXUSER
});

// table listing procedure worklist for user
const API_PROCEDURE_LIST = HOSTURL+'[[=URL('api','worklist')]]'+'?@count=true&id_auth_user.id.eq='+patientId+'&@lookup=id_auth_user!:id_auth_user[id,first_name,last_name],provider!:provider[id,first_name,last_name],procedure!:procedure,modality!:modality_dest[id,modality_name],receiving_facility!:receiving_facility[id,facility_name],sending_facility!:sending_facility[id,facility_name],senior!:senior[id,first_name,last_name],created_by!:created_by[id,first_name,last_name],modified_by!:modified_by[id,first_name,last_name]&@order=~id';
$table_wl = $('#table-wl').bootstrapTable({
    url: API_PROCEDURE_LIST,
    formatSearch: function () {
    return 'Procedure, modality';
    }
});

// table listing refraction right eye by user
const API_RXRIGHT = HOSTURL + "/"+APP_NAME+"/api/rx?id_auth_user.eq="+patientId+"&laterality.eq=right&@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id";
var $rxRight = $('#rxRight_tbl').bootstrapTable({
    url: API_RXRIGHT
});

// table listing refraction left eye by user
const API_RXLEFT = HOSTURL + "/"+APP_NAME+"/api/rx?id_auth_user.eq="+patientId+"&laterality.eq=left&@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id";
var $rxLeft = $('#rxLeft_tbl').bootstrapTable({
    url: API_RXLEFT
});

// table listing code encoded for worklist to user
const API_CODING = HOSTURL + "/"+APP_NAME+"/api/phistory?id_worklist.eq="+wlId+"&@lookup=disease!:id_disease_ref[id,title,category,icd10],mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id&id_auth_user.eq="+ patientId;
var $coding = $('#coding_tbl').bootstrapTable({
    url: API_CODING
});

// table listing medication encoded for current worklist 
const API_MXWLUSER = HOSTURL + "/"+APP_NAME+"/api/mx?id_worklist.eq="+wlId+"&@lookup=medication!:id_medic_ref[id,name,brand,form],mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id&id_auth_user.eq="+patientId;
var $mxWl_tbl = $('#mxWl_tbl').bootstrapTable({
    url: API_MXWLUSER
});

const API_TONORIGHT = HOSTURL + "/"+APP_NAME+"/api/tono?laterality.eq=right&@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id&id_auth_user="+patientId;
var $tonoRight_tbl = $('#tonoRight_tbl').bootstrapTable({
    url: API_TONORIGHT
});

const API_TONOLEFT = HOSTURL + "/"+APP_NAME+"/api/tono?laterality.eq=left&@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id&id_auth_user="+patientId;
var $tonoLeft_tbl = $('#tonoLeft_tbl').bootstrapTable({
    url: API_TONOLEFT
});

// table listing refraction right eye by user
const API_GXRX = HOSTURL + "/"+APP_NAME+"/api/glasses_rx_list?id_auth_user.eq="+patientId+"&@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id";
var $gxrx_tbl = $('#GxRx_tbl').bootstrapTable({
    url: API_GXRX
});

// table listing medication encoded for current worklist 
const API_MXRX = HOSTURL + "/"+APP_NAME+"/api/medical_rx_list?id_worklist.eq="+wlId+"&@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id";
var $mxrx_tbl = $('#mxrx_tbl').bootstrapTable({
    url: API_MXRX
});

// table listing refraction right eye by user
const API_CXRX = HOSTURL + "/"+APP_NAME+"/api/contacts_rx_list?id_auth_user.eq="+patientId+"&@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id";
var $cxrx_tbl = $('#cxrx_tbl').bootstrapTable({
    url: API_CXRX
});

// table listing refraction right eye by user
const API_CERT = HOSTURL + "/"+APP_NAME+"/api/certificates?id_auth_user.eq="+patientId+"&@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id";
var $cert_tbl = $('#cert_tbl').bootstrapTable({
    url: API_CERT
});

// table listing km right eye by user
const API_KMRIGHT = HOSTURL + "/"+APP_NAME+"/api/km?id_auth_user.eq="+patientId+"&laterality.eq=right&@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id";
var $kmRight = $('#kmRight_tbl').bootstrapTable({
    url: API_KMRIGHT
});

// table listing km right eye by user
const API_KMLEFT = HOSTURL + "/"+APP_NAME+"/api/km?id_auth_user.eq="+patientId+"&laterality.eq=left&@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id";
var $kmLeft = $('#kmLeft_tbl').bootstrapTable({
    url: API_KMLEFT
});

// table listing wlcodes right eye by user
const API_WLCODES = HOSTURL + "/"+APP_NAME+"/api/wl_codes?id_auth_user.eq="+patientId+"&id_worklist.eq="+wlId+"&@lookup=nomenclature:nomenclature_id[code,code_desc,price_list,supplement_ratio,not_compatible,min_reccurency,add_documents,min_age,max_age,covered],combo:combo_code[combo,combo_price],mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=[~id,~status]";
var $wlCodes = $('#wlCodes_tbl').bootstrapTable({
    url: API_WLCODES,
});



// tables list
const tablesArr = ['#mx_tbl','#ax_tbl','#mHx_tbl','#sHx_tbl', '#oHx_tbl', '#table-wl',
    '#rxRight_tbl','#rxLeft_tbl', '#coding_tbl', '#mxWl_tbl',
    '#kmRight_tbl', '#kmLeft_tbl',
    '#tonoRight_tbl', '#tonoLeft_tbl', '#GxRx_tbl', '#mxrx_tbl', '#cxrx_tbl', '#cert_tbl',
    '#wlCodes_tbl'
    ];

// init tinymce
tinymce.init({
    selector: '#certificateContent',
    height: '500px',
    plugins: 'save print code link table'
});

tinymce.init({
    selector: '#emailContent',
    height: '500px',
    plugins: 'save print code link table'
});

$( document ).ready(function() {
    if (document.referrer.includes('modalityCtr/autorx')) {
        refreshTables(['#rxRight_tbl','#rxLeft_tbl']);
        console.log('rx tables should be refreshed');
    };
    if (document.referrer.includes('modalityCtr/tono')) {
        refreshTables(['#tonoRight_tbl','#tonoLeft_tbl']);
        console.log('tono tables should be refreshed');
    };
});

$('#rxRight_tbl').on('post-body.bs.table', function () {
});

if (window.performance.getEntriesByType('navigation')[0].type == 'back_forward' || window.performance.getEntriesByType('navigation')[0].type == 'prerender') {
        console.log('tables:',tablesArr);
        refreshTables(tablesArr);
        console.log(' all tables should be refreshed');
};

</script>
<script src="js/md.js"></script>
<script src="js/prescription.js"></script>
<script src="js/glasses.js"></script>
<script src="js/contacts.js"></script>
<script src="js/certificates.js"></script>
[[ end ]]
