[[extend "baseof.html"]]

[[ block page_head]]
<link href="https://unpkg.com/bootstrap-table@1.18.2/dist/bootstrap-table.min.css" rel="stylesheet">
<style>
    /* overide when topnavbar is not fixed-top */
    section#main { margin-top: 0px; }
</style>
[[ end ]]

[[ block left_nav ]]
[[ end]]

[[ include 'partials/patient-bar.html' ]]

<div class="container-fluid mb-3">
    <div class="row text-center big-title mb-2" style="background-color: #E0F2F1;">
        <div class="col">
            <h1><a role="button" data-bs-toggle="collapse" href=".refraction">Refraction</a></h1>
        </div>
    </div>
    <div class="row d-flex justify-content-center align-items-center mx-2" style="background-color: #BBDEFB;">
        <div class="col text-center my-2" id="idGetFromMachines">
            <div>
                <button id="btnLink" class="btn btn-warning me-2" type="button"></button>
                <button id="btnGetFromL80" class="btn btn-primary btn-sm" type="button">L80</button>
                <button id="btnGetFromVx100" class="btn btn-primary btn-sm" type="button">VX100</button>
                <button id="btnGetFromCviris" class="btn btn-primary btn-sm" type="button">CV5 Iris</button>
                <button id="btnGetFromCvcrist" class="btn btn-primary btn-sm" type="button">CV5 Crist</button>
                <button id="btnGetFromCvcornea" class="btn btn-primary btn-sm" type="button">CV5 Cornea</button>
            </div>
        </div>
    </div>
    <div class="row mt-1 text-center refraction">
        <div class="col"> <!-- col right-->
            <div class="row"> <!-- row right title -->
                <div class="col title-right">
                    <h2>RIGHT EYE</h2>
                </div>
            </div>
            <div class="row"> <!-- row right form -->
                <div class="col">
                    <form id="idRightRx" enctype="multipart/form-data" method="POST">
                        <div class="container-fluid bg-right" >
                            <div class="row mb-3">
                                <div class="col">
                                    <label for="rx_origin_right" class="form-label">From:</label>
                                    <div class="input-group">
                                        <div class="btn-group rx_origin_right">
                                            <input type="radio" id="rx_origin_autorx_right" name="rx_origin" class="btn-check" value="autorx" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="rx_origin_autorx_right">AutoRx</label>
                                            <input type="radio" id="rx_origin_glass_right" name="rx_origin" class="btn-check" value="glass" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="rx_origin_glass_right">Glass</label>
                                            <input type="radio" id="rx_origin_trial_right" name="rx_origin" class="btn-check" value="trial" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="rx_origin_trial_right">Trial</label>
                                            <input type="radio" id="rx_origin_cyclo_right" name="rx_origin" class="btn-check" value="cyclo" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="rx_origin_cyclo_right">Cyclo</label>
                                            <input type="radio" id="rx_origin_dil" name="rx_origin" class="btn-check" value="dil" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="rx_origin_dil">Dil</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col" id="rightTypeDiv">
                                    <label for="glass_type" class="form-label">Type:</label>
                                    <div class="input-group">
                                        <div class="btn-group glass_type_right">
                                            <input type="radio" id="glass_type_mono_right" name="glass_type" class="btn-check" value="monofocal" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="glass_type_mono_right">Monofocal</label>
                                            <input type="radio" id="glass_type_prog_right" name="glass_type" class="btn-check" value="progressive" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="glass_type_prog_right">Progressive</label>
                                            <input type="radio" id="glass_type_bif_right" name="glass_type" class="btn-check" value="bifocal" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="glass_type_bif_right">Bifocal</label>
                                            <input type="radio" id="glass_type_deg_right" name="glass_type" class="btn-check" value="degressive" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="glass_type_deg_right">Degressive</label>
                                            <input type="radio" id="glass_type_na" name="glass_type" class="btn-check visually-hidden" value="na" autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                            </div> <!-- end row -->
                            <div class="row mb-3 rxDiv" id="farRight">
                                <div class="col-2">FAR</div>
                                <div class="col-2">
                                    <label for="sph_far" class="form-label">Sph:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_sph_far" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm sph_far counter_sph_far text-center" value ="+0.00" aria-label="Sphere right" name="sph_far">
                                        <button class="btn btn-outline-secondary counter_up_sph_far" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="cyl_far" class="form-label">Cyl:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_cyl_far" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm cyl_far counter_cyl_far text-center" value ="+0.00" aria-label="Cylinder right" name="cyl_far">
                                        <button class="btn btn-outline-secondary counter_up_cyl_far" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="axis_far" class="form-label">Axis:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_axis_far" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm axis_far counter_axis_far text-center" value ="180" aria-label="Cylinder right" name="axis_far">
                                        <button class="btn btn-outline-secondary counter_up_axis_far" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="va_far" class="form-label">VA:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_va_far" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm va_far counter_va_far text-center" value ="" aria-label="Visual acuity" name="va_far">
                                        <button class="btn btn-outline-secondary counter_up_va_far" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="opto_far" class="form-label">Opto:</label>
                                    <div class="input-group">
                                        <select class="form-select form-select-sm" aria-label="Default select example" name="opto_far">
                                            [[ = optoFarOptions]]
                                        </select>
                                    </div>
                                </div>
                            </div>                    
                            <div class="row mb-3 rxDiv" id="intRight">
                                <div class="col-2">
                                    <label for="add_int" class="form-label">Add for int:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_add_int" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm add_int counter_add_int text-center" value ="+0.00" aria-label="Intermediate addition" name="add_int">
                                        <button class="btn btn-outline-secondary counter_up_add_int" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="sph_int" class="form-label">Sph:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_sph_int" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm sph_int counter_sph_int text-center" value ="+0.00" aria-label="Sphere right" name="sph_int">
                                        <button class="btn btn-outline-secondary counter_up_sph_int" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="cyl_int" class="form-label">Cyl:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_cyl_int" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm cyl_int counter_cyl_int text-center" value ="+0.00" aria-label="Cylinder right" name="cyl_int">
                                        <button class="btn btn-outline-secondary counter_up_cyl_int" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="axis_int" class="form-label">Axis:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_axis_int" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm axis_int counter_axis_int text-center" value ="180" aria-label="Axis right" name="axis_int">
                                        <button class="btn btn-outline-secondary counter_up_axis_int" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="va_int" class="form-label">VA:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_va_int" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm va_int counter_va_int text-center" value ="1.00" aria-label="Visual acuity" name="va_int">
                                        <button class="btn btn-outline-secondary counter_up_va_int" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="opto_int" class="form-label">Opto:</label>
                                    <div class="input-group">
                                        <select class="form-select form-select-sm" aria-label="Optotype used for intermediate distance" name="opto_int">
                                            [[ = optoFarOptions]]
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-3 rxDiv" id="closeRight">
                                <div class="col-2">
                                    <label for="add_close" class="form-label">Add for close:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_add_close" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm add_close counter_add_close text-center" value ="+0.00" aria-label="Close addition" name="add_close">
                                        <button class="btn btn-outline-secondary counter_up_add_close" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="sph_close" class="form-label">Sph:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_sph_close" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm sph_close counter_sph_close text-center" value ="+0.00" aria-label="Sphere right" name="sph_close">
                                        <button class="btn btn-outline-secondary counter_up_sph_close" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="cyl_close" class="form-label">Cyl:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_cyl_close" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm cyl_close counter_cyl_close text-center" value ="+0.00" aria-label="Cylinder right" name="cyl_close">
                                        <button class="btn btn-outline-secondary counter_up_cyl_close" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="axis_close" class="form-label">Axis:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_axis_close" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm axis_close counter_axis_close text-center" value ="180" aria-label="Axis right" name="axis_close">
                                        <button class="btn btn-outline-secondary counter_up_axis_close" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="va_close" class="form-label">VA:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_va_close" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm va_close counter_va_close text-center" value ="2" aria-label="Visual acuity" name="va_close">
                                        <button class="btn btn-outline-secondary counter_up_va_close" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="opto_close" class="form-label">Opto:</label>
                                    <div class="input-group">
                                        <select class="form-select form-select-sm" aria-label="Optotype used for close" name="opto_close">
                                            [[ = optoCloseOptions]]
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col">
                                    <h4>SE(far)=<span class="SEf">0.00</span>D</h4>
                                </div>
                                <div class="col">
                                    <h4>SE(int)=<span class="SEi">0.00</span>D</h4>
                                </div>
                                <div class="col">
                                    <h4>SE(close)=<span class="SEc">0.00</span>D</h4>
                                </div>
                            </div>
                            <div class="row justify-content-center text-center mb-3">
                                <div class="col">
                                    <label for="ColorInputRight" class="form-label">Color picker</label>
                                    <input type="color" class="form-control form-control-color text-center" id="ColorInputRight" value="#FFFFFF" title="Choose glass color" name="color">
                                </div>
                                <div class="col">
                                    <label for="pd05Right" class="form-label">0.50PD:</label>
                                    <input id="pd05Right" type="text" class="form-control text-center" name="pd05" value="32">
                                    <div id="pd05RightHelp" class="form-text">Half pupils distance</div>
                                </div>
                                <div class="col">
                                    <label for="statusRxRight" class="form-label">Status:</label>
                                    <div class="input-group">
                                        <select id="statusRxRight" class="form-select text-center" aria-label="Choose status for rx" name="status">
                                            [[ = statusRxOptions]]
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col">
                                    <label for="timestampRight" class="form-label">Timestamp:</label>
                                    <input id="timestampRight" type="datetime-local" step="1" class="form-control" name="timestamp">
                                    <div id="requestTimeHelpRight" class="form-text">Adjust timestamp</div>
                                </div>
                                <div class="col">
                                    <label for="noteRight" class="form-label">Note:</label>
                                    <input id="noteRight" type="text" class="form-control" name="note">
                                    <div id="noteRightHelp" class="form-text">Note</div>
                                </div>
                            </div>
                            <div class="row mb-3 text-center">
                                <div class="row mb-3" id="rxRightSubmit">
                                    <div class="col">
                                        <button id="btnAddRxRight" class="btn btn-primary" type="submit">Submit right Rx<i class=" mx-2 fas fa-plus"></i></button>
                                    </div>
                                    <input id="idPatientWlRxRight" type="text" class="visually-hidden" name="id_auth_user"/>
                                    <input id="idWlRxRight" type="text" class="visually-hidden" name="id_worklist"/>
                                </div>
                            </div>
                        </div> <!--end container div-->
                    </form>
                </div>                
            </div>
        </div>  <!-- end col right-->
        <div class="col"> <!-- col left-->
            <div class="row"> <!-- row left title -->
                <div class="col title-left">
                    <h2>LEFT EYE</h2>
                </div>
            </div>
            <div class="row"> <!-- row left form -->
                <div class="col">
                    <form action="" id="idLeftRx">
                        <div class="container-fluid bg-left">
                            <div class="row mb-3">
                                <div class="col">
                                    <label for="rx_origin_left" class="form-label">From:</label>
                                    <div class="input-group">
                                        <div class="btn-group rx_origin_left">
                                            <input type="radio" id="rx_origin_autorx_left" name="rx_origin" class="btn-check" value="autorx" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="rx_origin_autorx_left">AutoRx</label>
                                            <input type="radio" id="rx_origin_glass_left" name="rx_origin" class="btn-check" value="glass" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="rx_origin_glass_left">Glass</label>
                                            <input type="radio" id="rx_origin_trial_left" name="rx_origin" class="btn-check" value="trial" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="rx_origin_trial_left">Trial</label>
                                            <input type="radio" id="rx_origin_cyclo_left" name="rx_origin" class="btn-check" value="cyclo" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="rx_origin_cyclo_left">Cyclo</label>
                                            <input type="radio" id="rx_origin_dil_left" name="rx_origin" class="btn-check" value="dil" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="rx_origin_dil_left">Dil</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col" id="leftTypeDiv">
                                    <label for="glass_type_left" class="form-label">Type:</label>
                                    <div class="input-group">
                                        <div class="btn-group glass_type_left">
                                            <input type="radio" id="glass_type_mono_left" name="glass_type" class="btn-check" value="monofocal" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="glass_type_mono_left">Monofocal</label>
                                            <input type="radio" id="glass_type_prog_left" name="glass_type" class="btn-check" value="progressive" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="glass_type_prog_left">Progressive</label>
                                            <input type="radio" id="glass_type_bif_left" name="glass_type" class="btn-check" value="bifocal" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="glass_type_bif_left">Bifocal</label>
                                            <input type="radio" id="glass_type_deg_left" name="glass_type" class="btn-check" value="degressive" autocomplete="off">
                                            <label class="btn btn-outline-primary" for="glass_type_deg_left">Degressive</label>
                                            <input type="radio" id="glass_type_na" name="glass_type" class="btn-check visually-hidden" value="na" autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                            </div> <!-- end row -->
                            <div class="row mb-3 rxDiv" id="farLeft">
                                <div class="col-2">FAR</div>
                                <div class="col-2">
                                    <label for="sph_far" class="form-label">Sph:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_sph_far" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm sph_far counter_sph_far text-center" value ="+0.00" aria-label="Sphere left" name="sph_far">
                                        <button class="btn btn-outline-secondary counter_up_sph_far" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="cyl_far" class="form-label">Cyl:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_cyl_far" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm cyl_far counter_cyl_far text-center" value ="+0.00" aria-label="Cylinder left" name="cyl_far">
                                        <button class="btn btn-outline-secondary counter_up_cyl_far" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="axis_far" class="form-label">Axis:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_axis_far" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm axis_far counter_axis_far text-center" value ="180" aria-label="Axis left" name="axis_far">
                                        <button class="btn btn-outline-secondary counter_up_axis_far" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="va_far" class="form-label">VA:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_va_far" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm va_far counter_va_far text-center" value ="" aria-label="Visual acuity" name="va_far">
                                        <button class="btn btn-outline-secondary counter_up_va_far" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="opto_far" class="form-label">Opto:</label>
                                    <div class="input-group">
                                        <select class="form-select form-select-sm" aria-label="Optotype for far" name="opto_far">
                                            [[ = optoFarOptions]]
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-3 rxDiv" id="intLeft">
                                <div class="col-2">
                                    <label for="add_int" class="form-label">Add for int:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_add_int" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm add_int counter_add_int text-center" value ="+0.00" aria-label="Intermediate addition" name="add_int">
                                        <button class="btn btn-outline-secondary counter_up_add_int" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="sph_int" class="form-label">Sph:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_sph_int" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm sph_int counter_sph_int text-center" value ="+0.00" aria-label="Sphere left" name="sph_int">
                                        <button class="btn btn-outline-secondary counter_up_sph_int" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="cyl_int" class="form-label">Cyl:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_cyl_int" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm cyl_int counter_cyl_int text-center" value ="+0.00" aria-label="Cylinder left" name="cyl_int">
                                        <button class="btn btn-outline-secondary counter_up_cyl_int" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="axis_int" class="form-label">Axis:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_axis_int" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm axis_int counter_axis_int text-center" value ="180" aria-label="Axis left" name="axis_int">
                                        <button class="btn btn-outline-secondary counter_up_axis_int" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="va_int" class="form-label">VA:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_va_int" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm va_int counter_va_int text-center" value ="1.00" aria-label="Visual acuity" name="va_int">
                                        <button class="btn btn-outline-secondary counter_up_va_int" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="opto_int" class="form-label">Opto:</label>
                                    <div class="input-group">
                                        <select class="form-select form-select-sm" aria-label="Optotype used for intermediate distance" name="opto_int">
                                            [[ = optoFarOptions]]
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-3 rxDiv" id="closeLeft">
                                <div class="col-2">
                                    <label for="add_close" class="form-label">Add for close:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_add_close" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm add_close counter_add_close text-center" value ="+0.00" aria-label="Close addition" name="add_close">
                                        <button class="btn btn-outline-secondary counter_up_add_close" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="sph_close" class="form-label">Sph:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_sph_close" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm sph_close counter_sph_close text-center" value ="+0.00" aria-label="Sphere left" name="sph_close">
                                        <button class="btn btn-outline-secondary counter_up_sph_close" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="cyl_close" class="form-label">Cyl:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_cyl_close" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm cyl_close counter_cyl_close text-center" value ="+0.00" aria-label="Cylinder left" name="cyl_close">
                                        <button class="btn btn-outline-secondary counter_up_cyl_close" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="axis_close" class="form-label">Axis:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_axis_close" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm axis_close counter_axis_close text-center" value ="180" aria-label="Axis left" name="axis_close">
                                        <button class="btn btn-outline-secondary counter_up_axis_close" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="va_close" class="form-label">VA:</label>
                                    <div class="input-group mb-3">
                                        <button class="btn btn-outline-secondary counter_down_va_close" type="button">-</button>
                                        <input type="text" class="form-control form-control-sm va_close counter_va_close text-center" value ="2" aria-label="Visual acuity" name="va_close">
                                        <button class="btn btn-outline-secondary counter_up_va_close" type="button">+</button>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <label for="opto_close" class="form-label">Opto:</label>
                                    <div class="input-group">
                                        <select class="form-select form-select-sm" aria-label="Optotype used for close" name="opto_close">
                                            [[ = optoCloseOptions]]
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col">
                                    <h4>SE(far)=<span class="SEf">0.00</span>D</h4>
                                </div>
                                <div class="col">
                                    <h4>SE(int)=<span class="SEi">0.00</span>D</h4>
                                </div>
                                <div class="col">
                                    <h4>SE(close)=<span class="SEc">0.00</span>D</h4>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col">
                                    <label for="ColorInputLeft" class="form-label">Color picker</label>
                                    <input type="color" class="form-control form-control-color text-center" id="ColorInputLeft" value="#FFFFFF" title="Choose glass color" name="color">
                                </div>
                                <div class="col">
                                    <label for="pd05Left" class="form-label">0.50PD:</label>
                                    <input id="pd05Left" type="text" class="form-control text-center" name="pd05" value="32">
                                    <div id="pd05LeftHelp" class="form-text">Half pupils distance</div>
                                </div>
                                <div class="col">
                                    <label for="statusRxLeft" class="form-label">Status:</label>
                                    <div class="input-group">
                                        <select id="statusRxLeft" class="form-select text-center" aria-label="Choose status for rx" name="status">
                                            [[ = statusRxOptions]]
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-4">
                                    <label for="timestampLeft" class="form-label">Timestamp:</label>
                                    <input id="timestampLeft" type="datetime-local" step="1" class="form-control" name="timestamp">
                                    <div id="requestTimeHelpLeft" class="form-text">Adjust timestamp</div>
                                </div>
                                <div class="col-8">
                                    <label for="noteLeft" class="form-label">Note:</label>
                                    <input id="noteLeft" type="text" class="form-control" name="note">
                                    <div id="noteLeftHelp" class="form-text">Note</div>
                                </div>
                            </div>
                            <div class="row mb-3 text-center">
                                <div class="row mb-3" id="rxLeftSubmit">
                                    <div class="col">
                                        <button id="btnAddRxLeft" class="btn btn-primary" type="submit">Submit left Rx<i class=" mx-2 fas fa-plus"></i></button>
                                    </div>
                                    <input id="idPatientWlRxLeft" type="text" class="visually-hidden" name="id_auth_user"/>
                                    <input id="idWlRxLeft" type="text" class="visually-hidden" name="id_worklist"/>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>  <!-- end col left-->
    </div> <!-- end main row -->
    <div class="row text-center mx-2">
        <div class="col">
            <button id="btnAddBothRx" class="btn btn-primary my-2" type="button">Submit Rx<i class=" mx-2 fas fa-plus"></i></button>
        </div>
    </div>
    <div class="row mt-3 text-center refraction">
        <div class="col"> <!-- col right-->
            <div class="row">
                <div class="col"> <!-- col table right -->
                    <table
                    id="rxRight_tbl"
                    data-side-pagination="server"
                    data-pagination="true"
                    data-page-size="5"
                    data-search="false"
                    data-query-params="queryParams"
                    data-response-handler="responseHandler"
                    data-detail-formatter="detailFormatter"
                    data-row-style="rowStyle_type"
                    data-detail-view="true"
                    data-detail-view-icon="true"
                    >
                        <thead>
                            <tr>
                                <th data-field="timestamp" data-sortable="true">Timestamp</th>
                                <th data-field="color" data-sortable="true" data-cell-style="cellStyle">Color</th>
                                <th data-field="rx_origin" data-sortable="true">Type</th>
                                <th data-field="note" data-sortable="false">Note</th>
                                <th data-field="va_far" data-sortable="true">VA far</th>
                                <th data-field="rx_far" data-cell-style="cellStyle_formula" data-sortable="false">Rx far</th>
                                <th data-field="se_far" data-sortable="false">SE</th>
                                <th data-field="add" data-cell-style="cellStyle_formula" data-sortable="false">Add</th>
                                <th data-field="va_close" data-sortable="true">VA close</th>
                                <th data-field="operate" data-formatter="operateFormatter" data-events="operateEvents">Action</th>
                            </tr>
                        </thead>
                    </table>
                </div> <!-- end col table right -->
            </div>
        </div>  <!-- end col left-->
        <div class="col"> <!-- col left-->
            <div class="row">
                <div class="col"> <!-- col table left -->
                    <table
                    id="rxLeft_tbl"
                    data-side-pagination="server"
                    data-pagination="true"
                    data-page-size="5"
                    data-search="false"
                    data-query-params="queryParams"
                    data-response-handler="responseHandler"
                    data-detail-formatter="detailFormatter"
                    data-row-style="rowStyle_type"
                    data-detail-view="true"
                    data-detail-view-icon="true"
                    >
                        <thead>
                            <tr>
                                <th data-field="timestamp" data-sortable="true">Timestamp</th>
                                <th data-field="color" data-sortable="true" data-cell-style="cellStyle">Color</th>
                                <th data-field="rx_origin" data-sortable="true">Type</th>
                                <th data-field="note" data-sortable="false">Note</th>
                                <th data-field="va_far" data-sortable="true">VA far</th>
                                <th data-field="rx_far" data-cell-style="cellStyle_formula" data-sortable="false">Rx far</th>
                                <th data-field="se_far" data-sortable="false">SE</th>
                                <th data-field="add" data-cell-style="cellStyle_formula" data-sortable="false">Add</th>
                                <th data-field="va_close" data-sortable="true">VA close</th>
                                <th data-field="operate" data-formatter="operateFormatter" data-events="operateEvents">Action</th>
                            </tr>
                        </thead>
                    </table>
                </div> <!-- end col table right -->
            </div>
        </div>  <!-- end col right-->
    </div>
</div>

<div class="container-fluid">
    <div class="row text-center big-title" style="background-color: #E0F2F1;">
        <h1><a role="button" data-bs-toggle="collapse" href=".keratometry">Keratometry</a></h1>
    </div>
    <div class="row mt-3 text-center keratometry">
        <div class="col"> <!-- col right -->
            <div class="row"> <!-- row right eye-->
                <div class="col title-right">
                    <h2>right eye</h2>
                </div>
            </div>
            <div class="row"> <!-- row form right -->
                <form id="idRightKm" enctype="multipart/form-data" method="POST">
                    <div class="container-fluid bg-right">
                        <div class="row mb-3">
                            <div class="col">
                                <label for="k1_right" class="form-label">K1:</label>
                                <div class="input-group mb-3">
                                    <button class="btn btn-outline-secondary counter_down_km1" type="button">-</button>
                                    <input type="text" class="form-control form-control-sm k1_right counter_km1 text-center" value ="43.00" aria-label="K1 right" name="k1">
                                    <button class="btn btn-outline-secondary counter_up_km1" type="button">+</button>
                                </div>
                                <label for="a1_right" class="form-label">Axis 1:</label>
                                <div class="input-group mb-3">
                                    <button class="btn btn-outline-secondary counter_down_axis1" type="button">-</button>
                                    <input type="text" class="form-control form-control-sm a1_right counter_axis1 text-center" value ="180" aria-label="Axis 1 right" name="axis1">
                                    <button class="btn btn-outline-secondary counter_up_axis1" type="button">+</button>
                                </div>
                            </div>
                            <div class="col">
                                <label for="k2_right" class="form-label">K2:</label>
                                <div class="input-group mb-3">
                                    <button class="btn btn-outline-secondary counter_down_km2" type="button">-</button>
                                    <input type="text" class="form-control form-control-sm k2_right counter_km2 text-center" value ="43.00" aria-label="K2 right" name="k2">
                                    <button class="btn btn-outline-secondary counter_up_km2" type="button">+</button>
                                </div>
                                <label for="a2_right" class="form-label">Axis 2:</label>
                                <div class="input-group mb-3">
                                    <button class="btn btn-outline-secondary counter_down_axis2" type="button">-</button>
                                    <input type="text" class="form-control form-control-sm a2_right counter_axis2 text-center" value ="180" aria-label="Axis 2 right" name="axis2">
                                    <button class="btn btn-outline-secondary counter_up_axis2" type="button">+</button>
                                </div>
                            </div>                            
                        </div>
                        <div class="row mb-3">
                            <div class="col">
                                <label for="notekRight" class="form-label">Note:</label>
                                <input id="notekRight" type="text" class="form-control" name="note">
                                <div id="noteLeftkHelp" class="form-text">Note</div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col">
                                <h4>Km= <span class="kmCalculated">43.00D</span></h4>
                            </div>
                            <div class="col">
                                <h4>K1= <span class="k1Calculated">7.85mm</span></h4>
                            </div>
                            <div class="col">
                                <h4>K1= <span class="k2Calculated">7.85mm</span></h4>
                            </div>
                        </div>
                        <div class="row pb-3" id="kmRightSubmit">
                            <div class="col">
                                <button id="btnAddKmRight" class="btn btn-primary" type="submit">Submit right Km<i class="mx-2 fas fa-plus"></i></button>
                            </div>
                            <input id="idPatientWlKmRight" type="text" class="visually-hidden" name="id_auth_user"/>
                            <input id="idWlKmRight" type="text" class="visually-hidden" name="id_worklist"/>
                        </div>
                    </div>
                </form>
            </div>
            <div class="row mt-3"> <!-- table right km -->
                <div class="col">
                    <table
                    id="kmRight_tbl"
                    data-side-pagination="server"
                    data-pagination="true"
                    data-page-size="5"
                    data-search="false"
                    data-query-params="queryParams"
                    data-response-handler="responseHandler_km"
                    data-detail-formatter="detailFormatter_km"
                    data-detail-view="true"
                    data-detail-view-icon="true"
                    >
                        <thead>
                            <tr>
                                <th data-field="timestamp" data-sortable="false">Timestamp</th>
                                <th data-field="k1" data-sortable="false">K1</th>
                                <th data-field="axis1" data-sortable="false">Axis 1</th>
                                <th data-field="k2" data-sortable="false">K2</th>
                                <th data-field="axis2" data-sortable="false">Axis 2</th>
                                <th data-field="operate" data-formatter="operateFormatter_km" data-events="operateEvents_km">Action</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
        <div class="col"> <!-- col left -->
            <div class="row"> <!-- row left eye-->
                <div class="col title-left">
                    <h2>left eye</h2>
                </div>
            </div>
            <div class="row mb-3"> <!-- row form left -->
                <form id="idLeftKm" enctype="multipart/form-data" method="POST">
                    <div class="container-fluid bg-left">
                        <div class="row mb-3">
                            <div class="col">
                                <label for="k1_left" class="form-label">K1:</label>
                                <div class="input-group mb-3">
                                    <button class="btn btn-outline-secondary counter_down_km1" type="button">-</button>
                                    <input type="text" class="form-control form-control-sm k1_left counter_km1 text-center" value ="43.00" aria-label="K1 left" name="k1">
                                    <button class="btn btn-outline-secondary counter_up_km1" type="button">+</button>
                                </div>
                                <label for="a1_left" class="form-label">Axis 1:</label>
                                <div class="input-group mb-3">
                                    <button class="btn btn-outline-secondary counter_down_axis1" type="button">-</button>
                                    <input type="text" class="form-control form-control-sm a1_left counter_axis1 text-center" value ="180" aria-label="Axis 1 left" name="axis1">
                                    <button class="btn btn-outline-secondary counter_up_axis1" type="button">+</button>
                                </div>
                            </div>
                            <div class="col">
                                <label for="k2_left" class="form-label">K2:</label>
                                <div class="input-group mb-3">
                                    <button class="btn btn-outline-secondary counter_down_km2" type="button">-</button>
                                    <input type="text" class="form-control form-control-sm k2_left counter_km2 text-center" value ="43.00" aria-label="K2 left" name="k2">
                                    <button class="btn btn-outline-secondary counter_up_km2" type="button">+</button>
                                </div>
                                <label for="a2_left" class="form-label">Axis 2:</label>
                                <div class="input-group mb-3">
                                    <button class="btn btn-outline-secondary counter_down_axis2" type="button">-</button>
                                    <input type="text" class="form-control form-control-sm a2_left counter_axis2 text-center" value ="180" aria-label="Axis 2 left" name="axis2">
                                    <button class="btn btn-outline-secondary counter_up_axis2" type="button">+</button>
                                </div>
                            </div>                            
                        </div>
                        <div class="row mb-3">
                            <div class="col">
                                <label for="notekLeft" class="form-label">Note:</label>
                                <input id="notekLeft" type="text" class="form-control" name="note">
                                <div id="noteLeftkHelp" class="form-text">Note</div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col">
                                <h4>Km= <span class="kmCalculated">43.00D</span></h4>
                            </div>
                            <div class="col">
                                <h4>K1= <span class="k1Calculated">7.85mm</span></h4> 
                            </div>
                            <div class="col">
                                <h4>K1= <span class="k2Calculated">7.85mm</span></h4>
                            </div>
                        </div>
                        <div class="row pb-3" id="kmLeftSubmit">
                            <div class="col">
                                <button id="btnAddKmLeft" class="btn btn-primary" type="submit">Submit left Km<i class="mx-2 fas fa-plus"></i></button>
                            </div>
                            <input id="idPatientWlKmLeft" type="text" class="visually-hidden" name="id_auth_user"/>
                            <input id="idWlKmLeft" type="text" class="visually-hidden" name="id_worklist"/>
                        </div>
                    </div>
                </form>
            </div>
            <div class="row"> <!-- table left -->
                <div class="col">
                    <table
                    id="kmLeft_tbl"
                    data-side-pagination="server"
                    data-pagination="true"
                    data-page-size="5"
                    data-search="false"
                    data-query-params="queryParams"
                    data-response-handler="responseHandler_km"
                    data-detail-formatter="detailFormatter_km"
                    data-detail-view="true"
                    data-detail-view-icon="true"
                    >
                        <thead>
                            <tr>
                                <th data-field="timestamp" data-sortable="false">Timestamp</th>
                                <th data-field="k1" data-sortable="false">K1</th>
                                <th data-field="axis1" data-sortable="false">Axis 1</th>
                                <th data-field="k2" data-sortable="false">K2</th>
                                <th data-field="axis2" data-sortable="false">Axis 2</th>
                                <th data-field="operate" data-formatter="operateFormatter_km" data-events="operateEvents_km">Action</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal RxModal -->
<div class="modal fade" id="rxModal" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Edit Rx</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <div class="row">
                        <div class="col">
                            <form id="rxFormModal" enctype="multipart/form-data" method="POST"> 
                                <div class="row mb-3">
                                    <div class="col">
                                        <label for="laterality_modal" class="form-label">Side:</label>
                                        <div class="input-group">
                                            <div class="btn-group laterality_modal">
                                                <input type="radio" id="laterality_right_modal" name="laterality" class="btn-check" value="right" autocomplete="off">
                                                <label class="btn btn-outline-primary" for="laterality_right_modal">Right</label>
                                                <input type="radio" id="laterality_left_modal" name="laterality" class="btn-check" value="left" autocomplete="off">
                                                <label class="btn btn-outline-primary" for="laterality_left_modal">Left</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <label for="rx_origin_modal" class="form-label">From:</label>
                                        <div class="input-group">
                                            <div class="btn-group rx_origin_modal">
                                                <input type="radio" id="rx_origin_autorx_modal" name="rx_origin" class="btn-check" value="autorx" autocomplete="off">
                                                <label class="btn btn-outline-primary" for="rx_origin_autorx_modal">AutoRx</label>
                                                <input type="radio" id="rx_origin_glass_modal" name="rx_origin" class="btn-check" value="glass" autocomplete="off">
                                                <label class="btn btn-outline-primary" for="rx_origin_glass_modal">Glass</label>
                                                <input type="radio" id="rx_origin_trial_modal" name="rx_origin" class="btn-check" value="trial" autocomplete="off">
                                                <label class="btn btn-outline-primary" for="rx_origin_trial_modal">Trial</label>
                                                <input type="radio" id="rx_origin_cyclo_modal" name="rx_origin" class="btn-check" value="cyclo" autocomplete="off">
                                                <label class="btn btn-outline-primary" for="rx_origin_cyclo_modal">Cyclo</label>
                                                <input type="radio" id="rx_origin_dil_modal" name="rx_origin" class="btn-check" value="dil" autocomplete="off">
                                                <label class="btn btn-outline-primary" for="rx_origin_dil_modal">Dil</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col" id="modalTypeDiv">
                                        <label for="glass_type_modal" class="form-label">Type:</label>
                                        <div class="input-group">
                                            <div class="btn-group glass_type_modal">
                                                <input type="radio" id="glass_type_mono_modal" name="glass_type" class="btn-check" value="monofocal" autocomplete="off">
                                                <label class="btn btn-outline-primary" for="glass_type_mono_modal">Monofocal</label>
                                                <input type="radio" id="glass_type_prog_modal" name="glass_type" class="btn-check" value="progressive" autocomplete="off">
                                                <label class="btn btn-outline-primary" for="glass_type_prog_modal">Progressive</label>
                                                <input type="radio" id="glass_type_bif_modal" name="glass_type" class="btn-check" value="bifocal" autocomplete="off">
                                                <label class="btn btn-outline-primary" for="glass_type_bif_modal">Bifocal</label>
                                                <input type="radio" id="glass_type_deg_modal" name="glass_type" class="btn-check" value="degressive" autocomplete="off">
                                                <label class="btn btn-outline-primary" for="glass_type_deg_modal">Degressive</label>
                                                <input type="radio" id="glass_type_na" name="glass_type" class="btn-check visually-hidden" value="na" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                </div> <!-- end row -->
                                <div class="row mb-3 rxDiv" id="farModal">
                                    <div class="col-2">FAR</div>
                                    <div class="col-2">
                                        <label for="sph_far" class="form-label">Sph:</label>
                                        <div class="input-group mb-3">
                                            <button class="btn btn-outline-secondary counter_down_sph_far" type="button">-</button>
                                            <input type="text" class="form-control form-control-sm sph_far counter_sph_far text-center" value ="+0.00" aria-label="Sphere left" name="sph_far">
                                            <button class="btn btn-outline-secondary counter_up_sph_far" type="button">+</button>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label for="cyl_far" class="form-label">Cyl:</label>
                                        <div class="input-group mb-3">
                                            <button class="btn btn-outline-secondary counter_down_cyl_far" type="button">-</button>
                                            <input type="text" class="form-control form-control-sm cyl_far counter_cyl_far text-center" value ="+0.00" aria-label="Cylinder left" name="cyl_far">
                                            <button class="btn btn-outline-secondary counter_up_cyl_far" type="button">+</button>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label for="axis_far" class="form-label">Axis:</label>
                                        <div class="input-group mb-3">
                                            <button class="btn btn-outline-secondary counter_down_axis_far" type="button">-</button>
                                            <input type="text" class="form-control form-control-sm axis_far counter_axis_far text-center" value ="180" aria-label="Axis left" name="axis_far">
                                            <button class="btn btn-outline-secondary counter_up_axis_far" type="button">+</button>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label for="va_far" class="form-label">VA:</label>
                                        <div class="input-group mb-3">
                                            <button class="btn btn-outline-secondary counter_down_va_far" type="button">-</button>
                                            <input type="text" class="form-control form-control-sm va_far counter_va_far text-center" value ="1.00" aria-label="Visual acuity" name="va_far">
                                            <button class="btn btn-outline-secondary counter_up_va_far" type="button">+</button>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label for="opto_far" class="form-label">Opto:</label>
                                        <div class="input-group">
                                            <select class="form-select form-select-sm" aria-label="Optotype for far" name="opto_far">
                                                [[ = optoFarOptions]]
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mb-3 rxDiv" id="intModal">
                                    <div class="col-2">
                                        <label for="add_int" class="form-label">Add for int:</label>
                                        <div class="input-group mb-3">
                                            <button class="btn btn-outline-secondary counter_down_add_int" type="button">-</button>
                                            <input type="text" class="form-control form-control-sm add_int counter_add_int text-center" value ="+0.00" aria-label="Intermediate addition" name="add_int">
                                            <button class="btn btn-outline-secondary counter_up_add_int" type="button">+</button>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label for="sph_int" class="form-label">Sph:</label>
                                        <div class="input-group mb-3">
                                            <button class="btn btn-outline-secondary counter_down_sph_int" type="button">-</button>
                                            <input type="text" class="form-control form-control-sm sph_int counter_sph_int text-center" value ="+0.00" aria-label="Sphere left" name="sph_int">
                                            <button class="btn btn-outline-secondary counter_up_sph_int" type="button">+</button>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label for="cyl_int" class="form-label">Cyl:</label>
                                        <div class="input-group mb-3">
                                            <button class="btn btn-outline-secondary counter_down_cyl_int" type="button">-</button>
                                            <input type="text" class="form-control form-control-sm cyl_int counter_cyl_int text-center" value ="+0.00" aria-label="Cylinder left" name="cyl_int">
                                            <button class="btn btn-outline-secondary counter_up_cyl_int" type="button">+</button>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label for="axis_int" class="form-label">Axis:</label>
                                        <div class="input-group mb-3">
                                            <button class="btn btn-outline-secondary counter_down_axis_int" type="button">-</button>
                                            <input type="text" class="form-control form-control-sm axis_int counter_axis_int text-center" value ="180" aria-label="Axis left" name="axis_int">
                                            <button class="btn btn-outline-secondary counter_up_axis_int" type="button">+</button>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label for="va_int" class="form-label">VA:</label>
                                        <div class="input-group mb-3">
                                            <button class="btn btn-outline-secondary counter_down_va_int" type="button">-</button>
                                            <input type="text" class="form-control form-control-sm va_int counter_va_int text-center" value ="1.00" aria-label="Visual acuity" name="va_int">
                                            <button class="btn btn-outline-secondary counter_up_va_int" type="button">+</button>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label for="opto_int" class="form-label">Opto:</label>
                                        <div class="input-group">
                                            <select class="form-select form-select-sm" aria-label="Optotype used for intermediate distance" name="opto_int">
                                                [[ = optoFarOptions]]
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mb-3 rxDiv" id="closeModal">
                                    <div class="col-2">
                                        <label for="add_close" class="form-label">Add for close:</label>
                                        <div class="input-group mb-3">
                                            <button class="btn btn-outline-secondary counter_down_add_close" type="button">-</button>
                                            <input type="text" class="form-control form-control-sm add_close counter_add_close text-center" value ="+0.00" aria-label="Close addition" name="add_close">
                                            <button class="btn btn-outline-secondary counter_up_add_close" type="button">+</button>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label for="sph_close" class="form-label">Sph:</label>
                                        <div class="input-group mb-3">
                                            <button class="btn btn-outline-secondary counter_down_sph_close" type="button">-</button>
                                            <input type="text" class="form-control form-control-sm sph_close counter_sph_close text-center" value ="+0.00" aria-label="Sphere left" name="sph_close">
                                            <button class="btn btn-outline-secondary counter_up_sph_close" type="button">+</button>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label for="cyl_close" class="form-label">Cyl:</label>
                                        <div class="input-group mb-3">
                                            <button class="btn btn-outline-secondary counter_down_cyl_close" type="button">-</button>
                                            <input type="text" class="form-control form-control-sm cyl_close counter_cyl_close text-center" value ="+0.00" aria-label="Cylinder left" name="cyl_close">
                                            <button class="btn btn-outline-secondary counter_up_cyl_close" type="button">+</button>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label for="axis_close" class="form-label">Axis:</label>
                                        <div class="input-group mb-3">
                                            <button class="btn btn-outline-secondary counter_down_axis_close" type="button">-</button>
                                            <input type="text" class="form-control form-control-sm axis_close counter_axis_close text-center" value ="180" aria-label="Axis left" name="axis_close">
                                            <button class="btn btn-outline-secondary counter_up_axis_close" type="button">+</button>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label for="va_close" class="form-label">VA:</label>
                                        <div class="input-group mb-3">
                                            <button class="btn btn-outline-secondary counter_down_va_close" type="button">-</button>
                                            <input type="text" class="form-control form-control-sm va_close counter_va_close text-center" value ="2" aria-label="Visual acuity" name="va_close">
                                            <button class="btn btn-outline-secondary counter_up_va_close" type="button">+</button>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <label for="opto_close" class="form-label">Opto:</label>
                                        <div class="input-group">
                                            <select class="form-select form-select-sm" aria-label="Optotype used for close" name="opto_close">
                                                [[ = optoCloseOptions]]
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mb-3">
                                    <div class="col">
                                        <h4>SE(far)=<span class="SEf">0.00</span>D</h4>
                                    </div>
                                    <div class="col">
                                        <h4>SE(int)=<span class="SEi">0.00</span>D</h4>
                                    </div>
                                    <div class="col">
                                        <h4>SE(close)=<span class="SEc">0.00</span>D</h4>
                                    </div>
                                </div>
                                <div class="row mb-3">
                                    <div class="col">
                                        <label for="noteModal" class="form-label">Note:</label>
                                        <input id="noteModal" type="text" class="form-control" name="note">
                                        <div id="noteModalHelp" class="form-text">Note</div>
                                    </div>
                                </div>                                                               
                                <div class="row mb-3">
                                    <div class="col">
                                        <label for="ColorInput" class="form-label">Color picker</label>
                                        <input type="color" class="form-control form-control-color text-center" id="ColorInput" title="Choose glass color" name="color">
                                    </div>
                                    <div class="col">
                                        <label for="pd05" class="form-label">0.50PD:</label>
                                        <input id="pd05" type="text" class="form-control text-center" name="pd05" value="32">
                                        <div id="pd05RightHelp" class="form-text">Half pupils distance</div>
                                    </div>
                                    <div class="col">
                                        <label for="timestamp" class="form-label">Timestamp:</label>
                                        <input id="timestamp" type="datetime-local" step="1" class="form-control" name="timestamp">
                                        <div id="requestTimeHelp" class="form-text">Adjust timestamp</div>
                                    </div> 
                                    <div class="col">
                                        <label for="statusRx" class="form-label">Status:</label>
                                        <div class="input-group">
                                            <select id="statusRx" class="form-select form-select-sm" aria-label="Choose status for rx" name="status">
                                                [[ = statusRxOptions]]
                                            </select>
                                        </div>
                                    </div>                               
                                </div>
                                <input id="idRx" type="text" class="visually-hidden" name="id"/>
                                <input id="idPatient" type="text" class="visually-hidden" name="id_auth_user"/>
                                <input id="idWl" type="text" class="visually-hidden" name="id_worklist"/>
                                <input id="methodRxModalSubmit" type="text" class="visually-hidden" name="methodRxModalSubmit" value="POST"/>
                                <input id="btnRxModalSubmit" type="submit" class="visually-hidden" />
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <label id="rxModalSubmit"for="btnRxModalSubmit" class="btn btn-primary" tabindex="0">Submit</label>
            </div>
        </div>
    </div>
</div>

<!-- Modal kmModal -->
<div class="modal fade" id="kmModal" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Edit Keratometry</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <div class="row">
                        <div class="col">
                            <form id="kmFormModal" enctype="multipart/form-data" method="POST"> 
                                <div class="container-fluid">
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label for="klaterality_modal" class="form-label">Side:</label>
                                            <div class="input-group">
                                                <div class="btn-group klaterality_modal">
                                                    <input type="radio" id="klaterality_right_modal" name="laterality" class="btn-check" value="right" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="klaterality_right_modal">Right</label>
                                                    <input type="radio" id="klaterality_left_modal" name="laterality" class="btn-check" value="left" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="klaterality_left_modal">Left</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col">
                                            <label for="ktimestamp" class="form-label">Timestamp:</label>
                                            <input id="ktimestamp" type="datetime-local" step="1" class="form-control" name="timestamp">
                                            <div id="ktimestampHelp" class="form-text">Adjust timestamp</div>
                                        </div> 
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label for="k1_modal" class="form-label">K1:</label>
                                            <div class="input-group mb-3">
                                                <button class="btn btn-outline-secondary counter_down_km1" type="button">-</button>
                                                <input type="text" class="form-control form-control-sm k1_modal counter_km1 text-center" value ="43.00" aria-label="K1" name="k1">
                                                <button class="btn btn-outline-secondary counter_up_km1" type="button">+</button>
                                            </div>
                                            <label for="a1_modal" class="form-label">Axis 1:</label>
                                            <div class="input-group mb-3">
                                                <button class="btn btn-outline-secondary counter_down_axis1" type="button">-</button>
                                                <input type="text" class="form-control form-control-sm a1_modal counter_axis1 text-center" value ="180" aria-label="Axis 1" name="axis1">
                                                <button class="btn btn-outline-secondary counter_up_axis1" type="button">+</button>
                                            </div>
                                        </div>
                                        <div class="col">
                                            <label for="k2_modal" class="form-label">K2:</label>
                                            <div class="input-group mb-3">
                                                <button class="btn btn-outline-secondary counter_down_km2" type="button">-</button>
                                                <input type="text" class="form-control form-control-sm k2_modal counter_km2 text-center" value ="43.00" aria-label="K2" name="k2">
                                                <button class="btn btn-outline-secondary counter_up_km2" type="button">+</button>
                                            </div>
                                            <label for="a2_modal" class="form-label">Axis 2:</label>
                                            <div class="input-group mb-3">
                                                <button class="btn btn-outline-secondary counter_down_axis2" type="button">-</button>
                                                <input type="text" class="form-control form-control-sm a2_modal counter_axis2 text-center" value ="180" aria-label="Axis 2" name="axis2">
                                                <button class="btn btn-outline-secondary counter_up_axis2" type="button">+</button>
                                            </div>
                                        </div>                            
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label for="notekModal" class="form-label">Note:</label>
                                            <input id="notekModal" type="text" class="form-control" name="note">
                                            <div id="notekModal" class="form-text">Note</div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <h4>Km= <span class="kmCalculated">43.00D</span></h4>
                                        </div>
                                        <div class="col">
                                            <h4>K1= <span class="k1Calculated">7.85mm</span></h4>
                                        </div>
                                        <div class="col">
                                            <h4>K1= <span class="k2Calculated">7.85mm</span></h4>
                                        </div>
                                    </div>
                                </div>
                                <input id="idKm" type="text" class="visually-hidden" name="id"/>
                                <input id="idPatientKm" type="text" class="visually-hidden" name="id_auth_user"/>
                                <input id="idWlKm" type="text" class="visually-hidden" name="id_worklist"/>
                                <input id="methodKmModalSubmit" type="text" class="visually-hidden" name="methodKmModalSubmit" value="PUT"/>
                                <input id="btnKmModalSubmit" type="submit" class="visually-hidden" />
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <label id="kmModalSubmit"for="btnKmModalSubmit" class="btn btn-primary" tabindex="0">Submit</label>
            </div>
        </div>
    </div>
</div>

<!-- Modal machineModal -->
<div class="modal fade" id="machineModal" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="importMachineTitle">Import from machine</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <div class="row">
                        <div class="col">
                            <div class="row"> <!-- table row div-->
                                <div class="col">
                                    <div class="title-right">RIGHT EYE</div>
                                    <table
                                        id="visionixRight_tbl"
                                        data-pagination="true"
                                        data-page-size="10"
                                        data-search="false"
                                        data-response-handler="responseHandler_vx"
                                        >
                                        <thead>
                                            <tr>
                                                <th data-field="date" data-sortable="true">Datetime</th>
                                                <th data-field="patient" data-sortable="false">Patient</th>
                                                <th data-field="exam" data-sortable="true">Exam</th>
                                                <th data-field="rx" data-sortable="false">Rx</th>
                                                <th data-field="k1str" data-sortable="false">K1</th>
                                                <th data-field="k2str" data-sortable="false">K2</th>
                                                <th data-field="operate" data-formatter="operateFormatter_vx" data-events="operateEvents_vx">Action</th>
                                                </th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                                <div class="col">
                                    <div class="title-left">LEFT EYE</div>
                                    <table
                                        id="visionixLeft_tbl"
                                        data-pagination="true"
                                        data-page-size="10"
                                        data-search="false"
                                        data-response-handler="responseHandler_vx"
                                        >
                                        <thead>
                                            <tr>
                                                <th data-field="date" data-sortable="true">Datetime</th>
                                                <th data-field="patient" data-sortable="false">Patient</th>
                                                <th data-field="exam" data-sortable="true">Exam</th>
                                                <th data-field="rx" data-sortable="false">Rx</th>
                                                <th data-field="k1str" data-sortable="false">K1</th>
                                                <th data-field="k2str" data-sortable="false">K2</th>
                                                <th data-field="operate" data-formatter="operateFormatter_vx" data-events="operateEvents_vx">Action</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </div> <!-- end machine table row div-->
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

[[ block js_scripts]]

<script type="text/javascript">
// Global variables
const HOSTURL = "[[ = hosturl ]]";
// submit btn to disable when done
const btnArr = ['#btnAddKmRight','#btnAddKmLeft', '#btnAddRxRight', '#btnAddRxLeft','#btnTaskDone', '#btnAddBothRx'];
</script>

<!-- <script src="js/bootstrap-table/bootstrap-table.min.js"></script> -->
<!-- <script src="js/bootstrap-table/bootstrap-table.js"></script> -->
<script src="js/bootstrap-table/bootstrap-table.min.js"></script>
<script src="js/bootbox/bootbox.all.min.js"></script>
<script src="js/jquery.serialize-object.min.js"></script>
<script src="js/useful.js"></script>
<script src="js/patient-bar.js"></script>
<script src="js/autorx_bt.js"></script>
<script type="text/javascript">

// init tables
const API_RXRIGHT = HOSTURL + "/myapp/api/rx?id_auth_user.eq="+patientId+"&laterality.eq=right&@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id";
const API_RXLEFT = HOSTURL + "/myapp/api/rx?id_auth_user.eq="+patientId+"&laterality.eq=left&@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id";
const API_KMRIGHT = HOSTURL + "/myapp/api/km?id_auth_user.eq="+patientId+"&laterality.eq=right&@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id";
const API_KMLEFT = HOSTURL + "/myapp/api/km?id_auth_user.eq="+patientId+"&laterality.eq=left&@lookup=mod!:modified_by[id,first_name,last_name],creator!:created_by[id,first_name,last_name]&@count=true&@order=~id";

var $rxRight = $('#rxRight_tbl').bootstrapTable({
    url: API_RXRIGHT
});

var $rxLeft = $('#rxLeft_tbl').bootstrapTable({
    url: API_RXLEFT
});

var $kmRight = $('#kmRight_tbl').bootstrapTable({
    url: API_KMRIGHT
});

var $kmLeft = $('#kmLeft_tbl').bootstrapTable({
    url: API_KMLEFT
});

const tablesArr = ['#rxRight_tbl','#rxLeft_tbl','#kmRight_tbl','#kmLeft_tbl'];

// Fires after the table body is rendered and available in the DOM, the parameters contain data
$('#rxRight_tbl').on('post-body.bs.table', function () {
    // $('#rxLeft_tbl').bootstrapTable('refresh');
    // $('.loading-wrap').addClass('visually-hidden'); // loading bug?
});

// table listing right measurement for patient in visionix
const API_L80_R = HOSTURL + '/myapp/rest/machines/l80?lastname='+removeAccent(patientObj['last_name']) +'&firstname='+removeAccent(patientObj['first_name'])+'&side=right'
const API_L80_L = HOSTURL + '/myapp/rest/machines/l80?lastname='+removeAccent(patientObj['last_name']) +'&firstname='+removeAccent(patientObj['first_name'])+'&side=left'
const API_VX100_R = HOSTURL + '/myapp/rest/machines/vx100?lastname='+removeAccent(patientObj['last_name']) +'&firstname='+removeAccent(patientObj['first_name'])+'&side=right'
const API_VX100_L = HOSTURL + '/myapp/rest/machines/vx100?lastname='+removeAccent(patientObj['last_name']) +'&firstname='+removeAccent(patientObj['first_name'])+'&side=left'
var $visionixright_tbl = $('#visionixRight_tbl').bootstrapTable({
    url: API_L80_R
});
var $visionixleft_tbl = $('#visionixLeft_tbl').bootstrapTable({
    url: API_L80_L
});

</script>
<script src="js/autorx.js"></script>
[[ end ]]
