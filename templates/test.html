[[extend "baseof.html"]]

[[ block page_head]]
<style>
    .table td {
        text-align: center;
    }
    .table th {
        text-align: center;
    }
</style>
<link href="https://unpkg.com/bootstrap-table@1.18.2/dist/bootstrap-table.min.css" rel="stylesheet">
[[ end ]]

[[ block left_nav ]]
[[ include 'partials/nav-test.html' ]]
[[ end]]

<!-- bootstrap ok for table -->
<div class="container-fluid"> <!-- #table list -->
    <div class="row">
      <div class="col-md-12 mt-3">
        <div>
            <h2><span class=""><i class="fas [[=class_icon]]"></i> [[=group]]s<span></h2>
            <div id="toolbar">
                <a href="javascript:" class="create btn btn-dark">New [[=group]]</a>
            </div>
        </div>
        <table id="table"
            data-toolbar="#toolbar"
            data-id-field="id"
            data-toggle="table"
            data-side-pagination="client"
            data-show-refresh="true"
            data-pagination="true"
            data-page-size="20"
            data-show-columns="true"
            data-search="true"
            data-visible-search="false"
            data-data-field="items"
            data-query-params=""
            >
            <thead class="thead-dark">
                <th data-field="id" data-sortable="true">ID</th>
                <th data-field="uid" data-sortable="true">UID</th>
                <th data-field="first_name" data-title="First name" data-sortable="true">First name:</th>
                <th data-field="last_name" data-sortable="true">Last name:</th>
                <th data-field="gender.sex" data-searchable= "true" data-sortable="true">Gender:</th>
                <th data-field="dob" data-sortable="true">Date of birth:</th>
            </thead>
        </table>
      </div>
    </div> <!-- end row -->
</div> <!-- end container fluid -->


<div>
    <p>Value is : [[=test]]</p>
</div>
<div>
    <p>User is: [[= globals().get('user',{}) ]]</p>
</div>

[[ block js_scripts]]
<script src="js/jquery-3.5.1.min.js"></script>
<!-- <script src="js/bootstrap-table/bootstrap-table.min.js"></script> -->
<!-- <script src="js/bootstrap-table/bootstrap-table.js"></script> -->
<script src="https://unpkg.com/bootstrap-table@1.18.2/dist/bootstrap-table.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="js/bootbox/bootbox.all.min.js"></script>
<script src="js/test.js"></script>
<script type="text/javascript">

// init bootstrat-tables
var membership = [[=membership]];
var HOSTURL = 'http://localhost:8000';

const API_USER_LIST= HOSTURL+'[[=URL('api','auth_user')]]'+'?membership.eq='+membership+'&@lookup=gender:gender[sex]&@limit=100&@order=last_name'; // check users with membership -> OK

console.log(API_USER_LIST);

var data = {
        "api_version": "0.1",
        "code": 200,
        "count": 2,
        "items": [
            {
                "birth_country": "Belgique",
                "birth_town": "Virginal-Samme",
                "chipnumber": null,
                "created_by": null,
                "created_on": "2021-02-21T23:39:19",
                "dob": null,
                "documenttype": null,
                "email": "mamisoa@gmail.com",
                "ethny": null,
                "first_name": "Mamisoa",
                "gender.sex": "Male",
                "id": 1,
                "idc_num": null,
                "initials": null,
                "last_name": "Andriantafika",
                "maiden_name": null,
                "marital": null,
                "membership": 1,
                "modified_by": null,
                "modified_on": "2021-02-21T23:39:19",
                "nationality": null,
                "noblecondition": null,
                "specialstatus": null,
                "ssn": null,
                "uid": "ca72ac93a0874cdeb25381b8cbb3e2a5",
                "user_notes": null,
                "username": "mamisoa",
                "validfrom": null,
                "validtill": null
            },
            {
                "birth_country": "Haiti",
                "birth_town": "Morelia",
                "chipnumber": "OWM22TDX4CT",
                "created_by": 1,
                "created_on": "2021-04-01T17:37:32",
                "dob": "1995-08-18",
                "documenttype": 8,
                "email": "zl89lr13282ip52@swdqv.wdz",
                "ethny": 2,
                "first_name": "Athena",
                "gender.sex": "Male",
                "id": 2,
                "idc_num": "ZBZ94MYF8RW",
                "initials": "G",
                "last_name": "Foley",
                "maiden_name": "Buck",
                "marital": 1,
                "membership": 1,
                "modified_by": 1,
                "modified_on": "2021-09-21T04:13:08",
                "nationality": "Saint Kitts and Nevis",
                "noblecondition": "Baron",
                "specialstatus": 4,
                "ssn": "QUW54TXW9UH",
                "uid": "1C86F043-1D3E-8115-5801-2CD3333C36BE",
                "user_notes": "L0V 5X3",
                "username": "evlbuy668",
                "validfrom": "2016-08-14",
                "validtill": "2021-04-08"
            }
        ],
        "status": "success",
        "timestamp": "2021-02-25T16:25:37.433241"
    }

var result=[];

    for (i in data.items) {
        result.push(data.items[i]);
    }

// console.log(result);

// $.getJSON( API_USER_LIST, function (data) {
//     results = data.items;
//     console.log(results);
//     console.log('Counted rows: '+results.length);
// })

/* result = [{"id":225,"last_name":"Andrian"}, { "id": 226, "last_name": "Andrian226" }]
 */

// $(function() {

// var $table = $('#table').bootstrapTable({
//         data: data,
//         formatSearch: function () {
//         return 'Hello'
//       }
// });

// });

// $(function() {

    var $table = $('#table').bootstrapTable({
        url: API_USER_LIST,
        formatSearch: function () {
        return 'Hello'
      }
    });

// });







</script>



[[ end ]]